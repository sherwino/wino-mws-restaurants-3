{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/sw.js"],"names":[],"mappings":"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","file":"sw.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","const staticCacheName = \"reviews-v1\";\r\nconst cacheItems = [\r\n  // Added all of the PWA items that should be cached like icons, and manifest\r\n  \"./\",\r\n  \"./css/styles.css\",\r\n  \"./css/restaurants.css\",\r\n  \"./css/mediaqueries.css\",\r\n  \"./restaurant.html\",\r\n  \"./index.html\",\r\n  \"./js/main.js\",\r\n  \"./js/restaurant_info.js\",\r\n  \"./manifest.json\",\r\n  \"./img/icons/icon-72x72.png\",\r\n  \"./img/icons/icon-96x96.png\",\r\n  \"./img/icons/icon-128x128.png\",\r\n  \"./img/icons/icon-144x144.png\",\r\n  \"./img/icons/icon-152x152.png\",\r\n  \"./img/icons/icon-192x192.png\",\r\n  \"./img/icons/icon-384x384.png\",\r\n  \"./img/icons/icon-512x512.png\"\r\n];\r\n\r\n// Listen for when worker is installed, then cache\r\nself.addEventListener(\"install\", event => {\r\n  event.waitUntil(\r\n    caches\r\n      .open(staticCacheName)\r\n      .then(cache => cache.addAll(cacheItems))\r\n      .catch(err => {\r\n        console.error(\"Could not open cached items in sw\", {\r\n          staticCacheName,\r\n          err\r\n        });\r\n      })\r\n  );\r\n});\r\n\r\n// Delete old caches, but first check if it is one of ours.\r\nself.addEventListener(\"activate\", event => {\r\n  event.waitUntil(\r\n    caches\r\n      .keys()\r\n      .then(cacheNames =>\r\n        Promise.all(\r\n          cacheNames\r\n            .filter(\r\n              cacheName =>\r\n                cacheName.startsWith(\"reviews-\") &&\r\n                cacheName !== staticCacheName\r\n            )\r\n            .map(cacheName => caches.delete(cacheName))\r\n        )\r\n      )\r\n  );\r\n});\r\n\r\n// When site makes a fetch request\r\n// Need to refactor this completely\r\nself.addEventListener(\"fetch\", event => {\r\n  const requestUrl = new URL(event.request.url);\r\n\r\n  // If the request was made from my site lets take a look at it\r\n  if (requestUrl.origin === location.origin) {\r\n    // So... for some reason the or statement I had before didn't work\r\n    // Previously tried to catch review and restaurants in the same if statement\r\n    // Now I am going to try to just do one for restaurants, and another for reviews\r\n    //   if (requestUrl.pathname.includes(\"restaurants\")) {\r\n    //       event.respondWith(caches.match('/restaurant.html'));\r\n    //   }\r\n\r\n    //   if (requestUrl.pathname.includes(\"reviews\")) {\r\n    //     event.respondWith(caches.match('/restaurant.html'));\r\n    //   }\r\n\r\n    // I saw this elsewhere, my images are not showing up in offline mode going to try this\r\n    if (requestUrl.pathname.endsWith(\".jpg\")) {\r\n      event.respondWith(cachedImages(event.request));\r\n    }\r\n  }\r\n\r\n  // And respond with a cached version\r\n  event.respondWith(\r\n    caches\r\n      .match(event.request, { ignoreSearch: true })\r\n      .then(res => res || fetch(event.request))\r\n  );\r\n});\r\n\r\n// This should help me serve images when offline\r\n// Also this is a mess, but I needed help\r\n// I should refactor to async await or do something else \r\nfunction cachedImages(request) {\r\n    const imgCacheName = `${staticCacheName}-img`;\r\n  let imgURL = request.url;\r\n  imgURL = imgURL.replace(/-small\\.\\w{3}|-medium\\.\\w{3}|-large\\.\\w{3}/i, \"\");\r\n\r\n  return caches.open(imgCacheName).then(imgCache => {\r\n    return imgCache\r\n      .match(imgURL)\r\n      .then(res => res || fetch(request))\r\n      .then(networkRes => {\r\n        imgCache.put(imgURL, networkRes.clone());\r\n        return networkRes;\r\n      })\r\n  });\r\n}\r\n\r\nself.addEventListener(\"message\", event => {\r\n  if (event.data.action === \"skipWaiting\") {\r\n    self.skipWaiting();\r\n  }\r\n});\r\n\r\nself.addEventListener(\"sync\", event => {\r\n  if (event.tag === \"restaurantSync\") {\r\n    event.waitUntil(doSomethingHere());\r\n  }\r\n});\r\n\r\nfunction doSomethingHere() {\r\n  console.log(\"I GUESSSS I DID SOMETHING HERE, on SYNC\");\r\n}\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvc3cuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLElBQU0sZUFBZSxHQUFHLFlBQXhCO0FBQ0EsSUFBTSxVQUFVLEdBQUcsQ0FDakI7QUFDQSxJQUZpQixFQUdqQixrQkFIaUIsRUFJakIsdUJBSmlCLEVBS2pCLHdCQUxpQixFQU1qQixtQkFOaUIsRUFPakIsY0FQaUIsRUFRakIsY0FSaUIsRUFTakIseUJBVGlCLEVBVWpCLGlCQVZpQixFQVdqQiw0QkFYaUIsRUFZakIsNEJBWmlCLEVBYWpCLDhCQWJpQixFQWNqQiw4QkFkaUIsRUFlakIsOEJBZmlCLEVBZ0JqQiw4QkFoQmlCLEVBaUJqQiw4QkFqQmlCLEVBa0JqQiw4QkFsQmlCLENBQW5CLEMsQ0FxQkE7O0FBQ0EsSUFBSSxDQUFDLGdCQUFMLENBQXNCLFNBQXRCLEVBQWlDLFVBQUEsS0FBSyxFQUFJO0FBQ3hDLEVBQUEsS0FBSyxDQUFDLFNBQU4sQ0FDRSxNQUFNLENBQ0gsSUFESCxDQUNRLGVBRFIsRUFFRyxJQUZILENBRVEsVUFBQSxLQUFLO0FBQUEsV0FBSSxLQUFLLENBQUMsTUFBTixDQUFhLFVBQWIsQ0FBSjtBQUFBLEdBRmIsRUFHRyxLQUhILENBR1MsVUFBQSxHQUFHLEVBQUk7QUFDWixJQUFBLE9BQU8sQ0FBQyxLQUFSLENBQWMsbUNBQWQsRUFBbUQ7QUFDakQsTUFBQSxlQUFlLEVBQWYsZUFEaUQ7QUFFakQsTUFBQSxHQUFHLEVBQUg7QUFGaUQsS0FBbkQ7QUFJRCxHQVJILENBREY7QUFXRCxDQVpELEUsQ0FjQTs7QUFDQSxJQUFJLENBQUMsZ0JBQUwsQ0FBc0IsVUFBdEIsRUFBa0MsVUFBQSxLQUFLLEVBQUk7QUFDekMsRUFBQSxLQUFLLENBQUMsU0FBTixDQUNFLE1BQU0sQ0FDSCxJQURILEdBRUcsSUFGSCxDQUVRLFVBQUEsVUFBVTtBQUFBLFdBQ2QsT0FBTyxDQUFDLEdBQVIsQ0FDRSxVQUFVLENBQ1AsTUFESCxDQUVJLFVBQUEsU0FBUztBQUFBLGFBQ1AsU0FBUyxDQUFDLFVBQVYsQ0FBcUIsVUFBckIsS0FDQSxTQUFTLEtBQUssZUFGUDtBQUFBLEtBRmIsRUFNRyxHQU5ILENBTU8sVUFBQSxTQUFTO0FBQUEsYUFBSSxNQUFNLENBQUMsTUFBUCxDQUFjLFNBQWQsQ0FBSjtBQUFBLEtBTmhCLENBREYsQ0FEYztBQUFBLEdBRmxCLENBREY7QUFlRCxDQWhCRCxFLENBa0JBO0FBQ0E7O0FBQ0EsSUFBSSxDQUFDLGdCQUFMLENBQXNCLE9BQXRCLEVBQStCLFVBQUEsS0FBSyxFQUFJO0FBQ3RDLE1BQU0sVUFBVSxHQUFHLElBQUksR0FBSixDQUFRLEtBQUssQ0FBQyxPQUFOLENBQWMsR0FBdEIsQ0FBbkIsQ0FEc0MsQ0FHdEM7O0FBQ0EsTUFBSSxVQUFVLENBQUMsTUFBWCxLQUFzQixRQUFRLENBQUMsTUFBbkMsRUFBMkM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQSxRQUFJLFVBQVUsQ0FBQyxRQUFYLENBQW9CLFFBQXBCLENBQTZCLE1BQTdCLENBQUosRUFBMEM7QUFDeEMsTUFBQSxLQUFLLENBQUMsV0FBTixDQUFrQixZQUFZLENBQUMsS0FBSyxDQUFDLE9BQVAsQ0FBOUI7QUFDRDtBQUNGLEdBcEJxQyxDQXNCdEM7OztBQUNBLEVBQUEsS0FBSyxDQUFDLFdBQU4sQ0FDRSxNQUFNLENBQ0gsS0FESCxDQUNTLEtBQUssQ0FBQyxPQURmLEVBQ3dCO0FBQUUsSUFBQSxZQUFZLEVBQUU7QUFBaEIsR0FEeEIsRUFFRyxJQUZILENBRVEsVUFBQSxHQUFHO0FBQUEsV0FBSSxHQUFHLElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQyxPQUFQLENBQWhCO0FBQUEsR0FGWCxDQURGO0FBS0QsQ0E1QkQsRSxDQThCQTtBQUNBO0FBQ0E7O0FBQ0EsU0FBUyxZQUFULENBQXNCLE9BQXRCLEVBQStCO0FBQzNCLE1BQU0sWUFBWSxhQUFNLGVBQU4sU0FBbEI7QUFDRixNQUFJLE1BQU0sR0FBRyxPQUFPLENBQUMsR0FBckI7QUFDQSxFQUFBLE1BQU0sR0FBRyxNQUFNLENBQUMsT0FBUCxDQUFlLDZDQUFmLEVBQThELEVBQTlELENBQVQ7QUFFQSxTQUFPLE1BQU0sQ0FBQyxJQUFQLENBQVksWUFBWixFQUEwQixJQUExQixDQUErQixVQUFBLFFBQVEsRUFBSTtBQUNoRCxXQUFPLFFBQVEsQ0FDWixLQURJLENBQ0UsTUFERixFQUVKLElBRkksQ0FFQyxVQUFBLEdBQUc7QUFBQSxhQUFJLEdBQUcsSUFBSSxLQUFLLENBQUMsT0FBRCxDQUFoQjtBQUFBLEtBRkosRUFHSixJQUhJLENBR0MsVUFBQSxVQUFVLEVBQUk7QUFDbEIsTUFBQSxRQUFRLENBQUMsR0FBVCxDQUFhLE1BQWIsRUFBcUIsVUFBVSxDQUFDLEtBQVgsRUFBckI7QUFDQSxhQUFPLFVBQVA7QUFDRCxLQU5JLENBQVA7QUFPRCxHQVJNLENBQVA7QUFTRDs7QUFFRCxJQUFJLENBQUMsZ0JBQUwsQ0FBc0IsU0FBdEIsRUFBaUMsVUFBQSxLQUFLLEVBQUk7QUFDeEMsTUFBSSxLQUFLLENBQUMsSUFBTixDQUFXLE1BQVgsS0FBc0IsYUFBMUIsRUFBeUM7QUFDdkMsSUFBQSxJQUFJLENBQUMsV0FBTDtBQUNEO0FBQ0YsQ0FKRDtBQU1BLElBQUksQ0FBQyxnQkFBTCxDQUFzQixNQUF0QixFQUE4QixVQUFBLEtBQUssRUFBSTtBQUNyQyxNQUFJLEtBQUssQ0FBQyxHQUFOLEtBQWMsZ0JBQWxCLEVBQW9DO0FBQ2xDLElBQUEsS0FBSyxDQUFDLFNBQU4sQ0FBZ0IsZUFBZSxFQUEvQjtBQUNEO0FBQ0YsQ0FKRDs7QUFNQSxTQUFTLGVBQVQsR0FBMkI7QUFDekIsRUFBQSxPQUFPLENBQUMsR0FBUixDQUFZLHlDQUFaO0FBQ0QiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCJjb25zdCBzdGF0aWNDYWNoZU5hbWUgPSBcInJldmlld3MtdjFcIjtcclxuY29uc3QgY2FjaGVJdGVtcyA9IFtcclxuICAvLyBBZGRlZCBhbGwgb2YgdGhlIFBXQSBpdGVtcyB0aGF0IHNob3VsZCBiZSBjYWNoZWQgbGlrZSBpY29ucywgYW5kIG1hbmlmZXN0XHJcbiAgXCIuL1wiLFxyXG4gIFwiLi9jc3Mvc3R5bGVzLmNzc1wiLFxyXG4gIFwiLi9jc3MvcmVzdGF1cmFudHMuY3NzXCIsXHJcbiAgXCIuL2Nzcy9tZWRpYXF1ZXJpZXMuY3NzXCIsXHJcbiAgXCIuL3Jlc3RhdXJhbnQuaHRtbFwiLFxyXG4gIFwiLi9pbmRleC5odG1sXCIsXHJcbiAgXCIuL2pzL21haW4uanNcIixcclxuICBcIi4vanMvcmVzdGF1cmFudF9pbmZvLmpzXCIsXHJcbiAgXCIuL21hbmlmZXN0Lmpzb25cIixcclxuICBcIi4vaW1nL2ljb25zL2ljb24tNzJ4NzIucG5nXCIsXHJcbiAgXCIuL2ltZy9pY29ucy9pY29uLTk2eDk2LnBuZ1wiLFxyXG4gIFwiLi9pbWcvaWNvbnMvaWNvbi0xMjh4MTI4LnBuZ1wiLFxyXG4gIFwiLi9pbWcvaWNvbnMvaWNvbi0xNDR4MTQ0LnBuZ1wiLFxyXG4gIFwiLi9pbWcvaWNvbnMvaWNvbi0xNTJ4MTUyLnBuZ1wiLFxyXG4gIFwiLi9pbWcvaWNvbnMvaWNvbi0xOTJ4MTkyLnBuZ1wiLFxyXG4gIFwiLi9pbWcvaWNvbnMvaWNvbi0zODR4Mzg0LnBuZ1wiLFxyXG4gIFwiLi9pbWcvaWNvbnMvaWNvbi01MTJ4NTEyLnBuZ1wiXHJcbl07XHJcblxyXG4vLyBMaXN0ZW4gZm9yIHdoZW4gd29ya2VyIGlzIGluc3RhbGxlZCwgdGhlbiBjYWNoZVxyXG5zZWxmLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnN0YWxsXCIsIGV2ZW50ID0+IHtcclxuICBldmVudC53YWl0VW50aWwoXHJcbiAgICBjYWNoZXNcclxuICAgICAgLm9wZW4oc3RhdGljQ2FjaGVOYW1lKVxyXG4gICAgICAudGhlbihjYWNoZSA9PiBjYWNoZS5hZGRBbGwoY2FjaGVJdGVtcykpXHJcbiAgICAgIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJDb3VsZCBub3Qgb3BlbiBjYWNoZWQgaXRlbXMgaW4gc3dcIiwge1xyXG4gICAgICAgICAgc3RhdGljQ2FjaGVOYW1lLFxyXG4gICAgICAgICAgZXJyXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pXHJcbiAgKTtcclxufSk7XHJcblxyXG4vLyBEZWxldGUgb2xkIGNhY2hlcywgYnV0IGZpcnN0IGNoZWNrIGlmIGl0IGlzIG9uZSBvZiBvdXJzLlxyXG5zZWxmLmFkZEV2ZW50TGlzdGVuZXIoXCJhY3RpdmF0ZVwiLCBldmVudCA9PiB7XHJcbiAgZXZlbnQud2FpdFVudGlsKFxyXG4gICAgY2FjaGVzXHJcbiAgICAgIC5rZXlzKClcclxuICAgICAgLnRoZW4oY2FjaGVOYW1lcyA9PlxyXG4gICAgICAgIFByb21pc2UuYWxsKFxyXG4gICAgICAgICAgY2FjaGVOYW1lc1xyXG4gICAgICAgICAgICAuZmlsdGVyKFxyXG4gICAgICAgICAgICAgIGNhY2hlTmFtZSA9PlxyXG4gICAgICAgICAgICAgICAgY2FjaGVOYW1lLnN0YXJ0c1dpdGgoXCJyZXZpZXdzLVwiKSAmJlxyXG4gICAgICAgICAgICAgICAgY2FjaGVOYW1lICE9PSBzdGF0aWNDYWNoZU5hbWVcclxuICAgICAgICAgICAgKVxyXG4gICAgICAgICAgICAubWFwKGNhY2hlTmFtZSA9PiBjYWNoZXMuZGVsZXRlKGNhY2hlTmFtZSkpXHJcbiAgICAgICAgKVxyXG4gICAgICApXHJcbiAgKTtcclxufSk7XHJcblxyXG4vLyBXaGVuIHNpdGUgbWFrZXMgYSBmZXRjaCByZXF1ZXN0XHJcbi8vIE5lZWQgdG8gcmVmYWN0b3IgdGhpcyBjb21wbGV0ZWx5XHJcbnNlbGYuYWRkRXZlbnRMaXN0ZW5lcihcImZldGNoXCIsIGV2ZW50ID0+IHtcclxuICBjb25zdCByZXF1ZXN0VXJsID0gbmV3IFVSTChldmVudC5yZXF1ZXN0LnVybCk7XHJcblxyXG4gIC8vIElmIHRoZSByZXF1ZXN0IHdhcyBtYWRlIGZyb20gbXkgc2l0ZSBsZXRzIHRha2UgYSBsb29rIGF0IGl0XHJcbiAgaWYgKHJlcXVlc3RVcmwub3JpZ2luID09PSBsb2NhdGlvbi5vcmlnaW4pIHtcclxuICAgIC8vIFNvLi4uIGZvciBzb21lIHJlYXNvbiB0aGUgb3Igc3RhdGVtZW50IEkgaGFkIGJlZm9yZSBkaWRuJ3Qgd29ya1xyXG4gICAgLy8gUHJldmlvdXNseSB0cmllZCB0byBjYXRjaCByZXZpZXcgYW5kIHJlc3RhdXJhbnRzIGluIHRoZSBzYW1lIGlmIHN0YXRlbWVudFxyXG4gICAgLy8gTm93IEkgYW0gZ29pbmcgdG8gdHJ5IHRvIGp1c3QgZG8gb25lIGZvciByZXN0YXVyYW50cywgYW5kIGFub3RoZXIgZm9yIHJldmlld3NcclxuICAgIC8vICAgaWYgKHJlcXVlc3RVcmwucGF0aG5hbWUuaW5jbHVkZXMoXCJyZXN0YXVyYW50c1wiKSkge1xyXG4gICAgLy8gICAgICAgZXZlbnQucmVzcG9uZFdpdGgoY2FjaGVzLm1hdGNoKCcvcmVzdGF1cmFudC5odG1sJykpO1xyXG4gICAgLy8gICB9XHJcblxyXG4gICAgLy8gICBpZiAocmVxdWVzdFVybC5wYXRobmFtZS5pbmNsdWRlcyhcInJldmlld3NcIikpIHtcclxuICAgIC8vICAgICBldmVudC5yZXNwb25kV2l0aChjYWNoZXMubWF0Y2goJy9yZXN0YXVyYW50Lmh0bWwnKSk7XHJcbiAgICAvLyAgIH1cclxuXHJcbiAgICAvLyBJIHNhdyB0aGlzIGVsc2V3aGVyZSwgbXkgaW1hZ2VzIGFyZSBub3Qgc2hvd2luZyB1cCBpbiBvZmZsaW5lIG1vZGUgZ29pbmcgdG8gdHJ5IHRoaXNcclxuICAgIGlmIChyZXF1ZXN0VXJsLnBhdGhuYW1lLmVuZHNXaXRoKFwiLmpwZ1wiKSkge1xyXG4gICAgICBldmVudC5yZXNwb25kV2l0aChjYWNoZWRJbWFnZXMoZXZlbnQucmVxdWVzdCkpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gQW5kIHJlc3BvbmQgd2l0aCBhIGNhY2hlZCB2ZXJzaW9uXHJcbiAgZXZlbnQucmVzcG9uZFdpdGgoXHJcbiAgICBjYWNoZXNcclxuICAgICAgLm1hdGNoKGV2ZW50LnJlcXVlc3QsIHsgaWdub3JlU2VhcmNoOiB0cnVlIH0pXHJcbiAgICAgIC50aGVuKHJlcyA9PiByZXMgfHwgZmV0Y2goZXZlbnQucmVxdWVzdCkpXHJcbiAgKTtcclxufSk7XHJcblxyXG4vLyBUaGlzIHNob3VsZCBoZWxwIG1lIHNlcnZlIGltYWdlcyB3aGVuIG9mZmxpbmVcclxuLy8gQWxzbyB0aGlzIGlzIGEgbWVzcywgYnV0IEkgbmVlZGVkIGhlbHBcclxuLy8gSSBzaG91bGQgcmVmYWN0b3IgdG8gYXN5bmMgYXdhaXQgb3IgZG8gc29tZXRoaW5nIGVsc2UgXHJcbmZ1bmN0aW9uIGNhY2hlZEltYWdlcyhyZXF1ZXN0KSB7XHJcbiAgICBjb25zdCBpbWdDYWNoZU5hbWUgPSBgJHtzdGF0aWNDYWNoZU5hbWV9LWltZ2A7XHJcbiAgbGV0IGltZ1VSTCA9IHJlcXVlc3QudXJsO1xyXG4gIGltZ1VSTCA9IGltZ1VSTC5yZXBsYWNlKC8tc21hbGxcXC5cXHd7M318LW1lZGl1bVxcLlxcd3szfXwtbGFyZ2VcXC5cXHd7M30vaSwgXCJcIik7XHJcblxyXG4gIHJldHVybiBjYWNoZXMub3BlbihpbWdDYWNoZU5hbWUpLnRoZW4oaW1nQ2FjaGUgPT4ge1xyXG4gICAgcmV0dXJuIGltZ0NhY2hlXHJcbiAgICAgIC5tYXRjaChpbWdVUkwpXHJcbiAgICAgIC50aGVuKHJlcyA9PiByZXMgfHwgZmV0Y2gocmVxdWVzdCkpXHJcbiAgICAgIC50aGVuKG5ldHdvcmtSZXMgPT4ge1xyXG4gICAgICAgIGltZ0NhY2hlLnB1dChpbWdVUkwsIG5ldHdvcmtSZXMuY2xvbmUoKSk7XHJcbiAgICAgICAgcmV0dXJuIG5ldHdvcmtSZXM7XHJcbiAgICAgIH0pXHJcbiAgfSk7XHJcbn1cclxuXHJcbnNlbGYuYWRkRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgZXZlbnQgPT4ge1xyXG4gIGlmIChldmVudC5kYXRhLmFjdGlvbiA9PT0gXCJza2lwV2FpdGluZ1wiKSB7XHJcbiAgICBzZWxmLnNraXBXYWl0aW5nKCk7XHJcbiAgfVxyXG59KTtcclxuXHJcbnNlbGYuYWRkRXZlbnRMaXN0ZW5lcihcInN5bmNcIiwgZXZlbnQgPT4ge1xyXG4gIGlmIChldmVudC50YWcgPT09IFwicmVzdGF1cmFudFN5bmNcIikge1xyXG4gICAgZXZlbnQud2FpdFVudGlsKGRvU29tZXRoaW5nSGVyZSgpKTtcclxuICB9XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gZG9Tb21ldGhpbmdIZXJlKCkge1xyXG4gIGNvbnNvbGUubG9nKFwiSSBHVUVTU1NTIEkgRElEIFNPTUVUSElORyBIRVJFLCBvbiBTWU5DXCIpO1xyXG59XHJcbiJdfQ=="}