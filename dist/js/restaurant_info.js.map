{"version":3,"sources":["node_modules/browser-pack/_prelude.js","node_modules/idb/lib/idb.js","src/js/browser.js","src/js/dbhelper.js","src/js/dbpromise.js","src/js/register.js","src/js/restaurant_info.js","src/js/reviewform.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;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","file":"restaurant_info.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","'use strict';\n\n(function() {\n  function toArray(arr) {\n    return Array.prototype.slice.call(arr);\n  }\n\n  function promisifyRequest(request) {\n    return new Promise(function(resolve, reject) {\n      request.onsuccess = function() {\n        resolve(request.result);\n      };\n\n      request.onerror = function() {\n        reject(request.error);\n      };\n    });\n  }\n\n  function promisifyRequestCall(obj, method, args) {\n    var request;\n    var p = new Promise(function(resolve, reject) {\n      request = obj[method].apply(obj, args);\n      promisifyRequest(request).then(resolve, reject);\n    });\n\n    p.request = request;\n    return p;\n  }\n\n  function promisifyCursorRequestCall(obj, method, args) {\n    var p = promisifyRequestCall(obj, method, args);\n    return p.then(function(value) {\n      if (!value) return;\n      return new Cursor(value, p.request);\n    });\n  }\n\n  function proxyProperties(ProxyClass, targetProp, properties) {\n    properties.forEach(function(prop) {\n      Object.defineProperty(ProxyClass.prototype, prop, {\n        get: function() {\n          return this[targetProp][prop];\n        },\n        set: function(val) {\n          this[targetProp][prop] = val;\n        }\n      });\n    });\n  }\n\n  function proxyRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function proxyMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return this[targetProp][prop].apply(this[targetProp], arguments);\n      };\n    });\n  }\n\n  function proxyCursorRequestMethods(ProxyClass, targetProp, Constructor, properties) {\n    properties.forEach(function(prop) {\n      if (!(prop in Constructor.prototype)) return;\n      ProxyClass.prototype[prop] = function() {\n        return promisifyCursorRequestCall(this[targetProp], prop, arguments);\n      };\n    });\n  }\n\n  function Index(index) {\n    this._index = index;\n  }\n\n  proxyProperties(Index, '_index', [\n    'name',\n    'keyPath',\n    'multiEntry',\n    'unique'\n  ]);\n\n  proxyRequestMethods(Index, '_index', IDBIndex, [\n    'get',\n    'getKey',\n    'getAll',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(Index, '_index', IDBIndex, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  function Cursor(cursor, request) {\n    this._cursor = cursor;\n    this._request = request;\n  }\n\n  proxyProperties(Cursor, '_cursor', [\n    'direction',\n    'key',\n    'primaryKey',\n    'value'\n  ]);\n\n  proxyRequestMethods(Cursor, '_cursor', IDBCursor, [\n    'update',\n    'delete'\n  ]);\n\n  // proxy 'next' methods\n  ['advance', 'continue', 'continuePrimaryKey'].forEach(function(methodName) {\n    if (!(methodName in IDBCursor.prototype)) return;\n    Cursor.prototype[methodName] = function() {\n      var cursor = this;\n      var args = arguments;\n      return Promise.resolve().then(function() {\n        cursor._cursor[methodName].apply(cursor._cursor, args);\n        return promisifyRequest(cursor._request).then(function(value) {\n          if (!value) return;\n          return new Cursor(value, cursor._request);\n        });\n      });\n    };\n  });\n\n  function ObjectStore(store) {\n    this._store = store;\n  }\n\n  ObjectStore.prototype.createIndex = function() {\n    return new Index(this._store.createIndex.apply(this._store, arguments));\n  };\n\n  ObjectStore.prototype.index = function() {\n    return new Index(this._store.index.apply(this._store, arguments));\n  };\n\n  proxyProperties(ObjectStore, '_store', [\n    'name',\n    'keyPath',\n    'indexNames',\n    'autoIncrement'\n  ]);\n\n  proxyRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'put',\n    'add',\n    'delete',\n    'clear',\n    'get',\n    'getAll',\n    'getKey',\n    'getAllKeys',\n    'count'\n  ]);\n\n  proxyCursorRequestMethods(ObjectStore, '_store', IDBObjectStore, [\n    'openCursor',\n    'openKeyCursor'\n  ]);\n\n  proxyMethods(ObjectStore, '_store', IDBObjectStore, [\n    'deleteIndex'\n  ]);\n\n  function Transaction(idbTransaction) {\n    this._tx = idbTransaction;\n    this.complete = new Promise(function(resolve, reject) {\n      idbTransaction.oncomplete = function() {\n        resolve();\n      };\n      idbTransaction.onerror = function() {\n        reject(idbTransaction.error);\n      };\n      idbTransaction.onabort = function() {\n        reject(idbTransaction.error);\n      };\n    });\n  }\n\n  Transaction.prototype.objectStore = function() {\n    return new ObjectStore(this._tx.objectStore.apply(this._tx, arguments));\n  };\n\n  proxyProperties(Transaction, '_tx', [\n    'objectStoreNames',\n    'mode'\n  ]);\n\n  proxyMethods(Transaction, '_tx', IDBTransaction, [\n    'abort'\n  ]);\n\n  function UpgradeDB(db, oldVersion, transaction) {\n    this._db = db;\n    this.oldVersion = oldVersion;\n    this.transaction = new Transaction(transaction);\n  }\n\n  UpgradeDB.prototype.createObjectStore = function() {\n    return new ObjectStore(this._db.createObjectStore.apply(this._db, arguments));\n  };\n\n  proxyProperties(UpgradeDB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(UpgradeDB, '_db', IDBDatabase, [\n    'deleteObjectStore',\n    'close'\n  ]);\n\n  function DB(db) {\n    this._db = db;\n  }\n\n  DB.prototype.transaction = function() {\n    return new Transaction(this._db.transaction.apply(this._db, arguments));\n  };\n\n  proxyProperties(DB, '_db', [\n    'name',\n    'version',\n    'objectStoreNames'\n  ]);\n\n  proxyMethods(DB, '_db', IDBDatabase, [\n    'close'\n  ]);\n\n  // Add cursor iterators\n  // TODO: remove this once browsers do the right thing with promises\n  ['openCursor', 'openKeyCursor'].forEach(function(funcName) {\n    [ObjectStore, Index].forEach(function(Constructor) {\n      // Don't create iterateKeyCursor if openKeyCursor doesn't exist.\n      if (!(funcName in Constructor.prototype)) return;\n\n      Constructor.prototype[funcName.replace('open', 'iterate')] = function() {\n        var args = toArray(arguments);\n        var callback = args[args.length - 1];\n        var nativeObject = this._store || this._index;\n        var request = nativeObject[funcName].apply(nativeObject, args.slice(0, -1));\n        request.onsuccess = function() {\n          callback(request.result);\n        };\n      };\n    });\n  });\n\n  // polyfill getAll\n  [Index, ObjectStore].forEach(function(Constructor) {\n    if (Constructor.prototype.getAll) return;\n    Constructor.prototype.getAll = function(query, count) {\n      var instance = this;\n      var items = [];\n\n      return new Promise(function(resolve) {\n        instance.iterateCursor(query, function(cursor) {\n          if (!cursor) {\n            resolve(items);\n            return;\n          }\n          items.push(cursor.value);\n\n          if (count !== undefined && items.length == count) {\n            resolve(items);\n            return;\n          }\n          cursor.continue();\n        });\n      });\n    };\n  });\n\n  var exp = {\n    open: function(name, version, upgradeCallback) {\n      var p = promisifyRequestCall(indexedDB, 'open', [name, version]);\n      var request = p.request;\n\n      if (request) {\n        request.onupgradeneeded = function(event) {\n          if (upgradeCallback) {\n            upgradeCallback(new UpgradeDB(request.result, event.oldVersion, request.transaction));\n          }\n        };\n      }\n\n      return p.then(function(db) {\n        return new DB(db);\n      });\n    },\n    delete: function(name) {\n      return promisifyRequestCall(indexedDB, 'deleteDatabase', [name]);\n    }\n  };\n\n  if (typeof module !== 'undefined') {\n    module.exports = exp;\n    module.exports.default = module.exports;\n  }\n  else {\n    self.idb = exp;\n  }\n}());\n","let usersBrowser;\r\nconst { userAgent } = navigator;\r\n\r\n// The order matters here, and this may report false positives for unlisted browsers.\r\nif (userAgent.indexOf('Firefox') > -1) {\r\n    usersBrowser = 'Mozilla Firefox';\r\n} else if (userAgent.indexOf('Opera') > -1) {\r\n    usersBrowser = 'Opera';\r\n} else if (userAgent.indexOf('Trident') > -1) {\r\n    usersBrowser = 'Microsoft Internet Explorer';\r\n} else if (userAgent.indexOf('Edge') > -1) {\r\n    usersBrowser = 'Microsoft Edge';\r\n} else if (userAgent.indexOf('Chrome') > -1) {\r\n    usersBrowser = 'Google Chrome or Chromium';\r\n} else if (userAgent.indexOf('Safari') > -1) {\r\n    usersBrowser = 'Apple Safari';\r\n} else {\r\n    usersBrowser = 'unknown';\r\n}\r\n\r\nconsole.log(`You are using: ${usersBrowser}`);\r\n","import dbPromise from \"./dbpromise\";\r\n\r\n/**\r\n * Common database helper functions.\r\n */\r\nexport default class DBHelper {\r\n  /**\r\n   * API URL\r\n   */\r\n  static get API_URL() {\r\n    const port = 1337; // port where sails server will listen.\r\n\r\n    const heroku = \"https://winosails.herokuapp.com\";\r\n    const isLocalHost = () => {\r\n      if (window.location.hostname.includes(\"localhost\")) {\r\n        return `http://localhost:${port}`;\r\n      }\r\n    };\r\n\r\n    const url = isLocalHost() || heroku;\r\n\r\n    return url;\r\n  }\r\n\r\n  /**\r\n   * Fetch all restaurants.\r\n   */\r\n  static fetchRestaurants(callback) {\r\n    this.syncOfflinefav()\r\n    let xhr = new XMLHttpRequest();\r\n    xhr.open(\"GET\", `${DBHelper.API_URL}/restaurants`);\r\n    xhr.onload = () => {\r\n      if (xhr.status === 200) {\r\n        const restaurants = JSON.parse(xhr.responseText);\r\n        dbPromise.putRestaurants(restaurants);\r\n        callback(null, restaurants);\r\n      } else {\r\n        // Oops!. Got an error from server.\r\n        console.log(\r\n          `Request failed. Returned status of ${xhr.status}, trying idb...`\r\n        );\r\n        // if xhr request isn't code 200, try idb\r\n        dbPromise.getRestaurants().then(idbRestaurants => {\r\n          if (idbRestaurants.length) {\r\n            callback(null, idbRestaurants);\r\n          } else {\r\n            callback(\"No restaurants found in idb\", null);\r\n          }\r\n        });\r\n      }\r\n    };\r\n    // XHR needs error handling for when server is down (doesn't respond or sends back codes)\r\n    xhr.onerror = () => {\r\n      console.log(\"Error while trying XHR, trying idb...\");\r\n      // try idb, and if we get restaurants back, return them, otherwise return an error\r\n      dbPromise.getRestaurants().then(idbRestaurants => {\r\n        if (idbRestaurants.length) {\r\n          callback(null, idbRestaurants);\r\n        } else {\r\n          callback(\"No restaurants found in idb\", null);\r\n        }\r\n      });\r\n    };\r\n    xhr.send();\r\n  }\r\n\r\n  /**\r\n   * Fetch a restaurant by its ID.\r\n   */\r\n  static fetchRestaurantById(id, callback) {\r\n    this.syncOfflineReviews();\r\n    fetch(`${DBHelper.API_URL}/restaurants/${id}`)\r\n      .then(response => {\r\n        if (!response.ok)\r\n          return Promise.reject(\"Restaurant couldn't be fetched from network\");\r\n        return response.json();\r\n      })\r\n      .then(fetchedRestaurant => {\r\n        // if restaurant could be fetched from network:\r\n        dbPromise.putRestaurants(fetchedRestaurant);\r\n        return callback(null, fetchedRestaurant);\r\n      })\r\n      .catch(networkError => {\r\n        // if restaurant couldn't be fetched from network:\r\n        console.log(`${networkError}, trying idb.`);\r\n        dbPromise.getRestaurants(id).then(idbRestaurant => {\r\n          if (!idbRestaurant)\r\n            return callback(\"Restaurant not found in idb either\", null);\r\n          return callback(null, idbRestaurant);\r\n        });\r\n      });\r\n  }\r\n\r\n  /**\r\n   * Fetch restaurant reviews by restaurant id.\r\n   */\r\n  static fetchsReviewsByRestaurantId(id) {\r\n    return dbPromise.getReviewsForRestaurant(id).then(idbReviews => {\r\n      if (!idbReviews.length) {\r\n        console.info(\"No reviews in idb\", idbReviews);\r\n        console.info(\"Fetching from API\");\r\n\r\n        return fetch(`${DBHelper.API_URL}/reviews/?restaurant_id=${id}`)\r\n          .then(response => response.json())\r\n          .then(fetchedReviews => {\r\n            console.info(\"Found Reviews saving to idb\");\r\n            dbPromise.putReviews(fetchedReviews);\r\n\r\n            return fetchedReviews;\r\n          })\r\n          .catch(err => {\r\n            console.error(\"Reviews couldn't be fetched from network, sorry.\");\r\n          });\r\n      } else {\r\n        console.info(\"Found reviews on idb\");\r\n\r\n        return idbReviews;\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * I have an idb collection of offline messages that need to get online\r\n   */\r\n  static syncOfflineReviews() {\r\n    return dbPromise.getOfflineReviews().then(reviews => {\r\n      // If we actually got some reviews, send them to idb, not sure if I send whole object\r\n      if (reviews) {\r\n        const url = `${DBHelper.API_URL}/reviews/`;\r\n        const POST = {\r\n          method: \"POST\",\r\n          body: JSON.stringify(reviews)\r\n        };\r\n\r\n        return fetch(url, POST).then(response => {\r\n          if (!response.ok) {\r\n            return Promise.reject(\"We couldn't post review to server.\");\r\n          }\r\n          console.info(\"Posted offline reviews to api successfully\");\r\n          return response.json();\r\n        });\r\n      }\r\n      return null;\r\n    });\r\n  }\r\n\r\n    /**\r\n   * I have an idb collection of offline messages that need to get online\r\n   */\r\n  static syncOfflinefav() {\r\n    return dbPromise.getOfflinefavs().then(favs => {\r\n      // If we actually got some favs, send them to idb\r\n      if (favs) {\r\n        const url = `${DBHelper.API_URL}/restaurants/${restaurantId}/?is_favorite=${!fav}`;\r\n        const PUT = {\r\n          method: \"PUT\",\r\n        };\r\n\r\n        return fetch(url, PUT).then(response => {\r\n          if (!response.ok) {\r\n            return Promise.reject(\"We couldn't post fav to server.\");\r\n          }\r\n          console.info(\"Posted offline favs to api successfully\");\r\n          return response.json();\r\n        });\r\n      }\r\n      return null;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Fetch restaurants by a cuisine type with proper error handling.\r\n   */\r\n  static fetchRestaurantByCuisine(cuisine, callback) {\r\n    // Fetch all restaurants  with proper error handling\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Filter restaurants to have only given cuisine type\r\n        const results = restaurants.filter(r => r.cuisine_type == cuisine);\r\n        callback(null, results);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Fetch restaurants by a neighborhood with proper error handling.\r\n   */\r\n  static fetchRestaurantByNeighborhood(neighborhood, callback) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Filter restaurants to have only given neighborhood\r\n        const results = restaurants.filter(r => r.neighborhood == neighborhood);\r\n        callback(null, results);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Fetch restaurants by a cuisine and a neighborhood with proper error handling.\r\n   */\r\n  static fetchRestaurantByCuisineAndNeighborhood(\r\n    cuisine,\r\n    neighborhood,\r\n    callback\r\n  ) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        let results = restaurants;\r\n        if (cuisine != \"all\") {\r\n          // filter by cuisine\r\n          results = results.filter(r => r.cuisine_type == cuisine);\r\n        }\r\n        if (neighborhood != \"all\") {\r\n          // filter by neighborhood\r\n          results = results.filter(r => r.neighborhood == neighborhood);\r\n        }\r\n        callback(null, results);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Fetch all neighborhoods with proper error handling.\r\n   */\r\n  static fetchNeighborhoods(callback) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Get all neighborhoods from all restaurants\r\n        const neighborhoods = restaurants.map(\r\n          (v, i) => restaurants[i].neighborhood\r\n        );\r\n        // Remove duplicates from neighborhoods\r\n        const uniqueNeighborhoods = neighborhoods.filter(\r\n          (v, i) => neighborhoods.indexOf(v) == i\r\n        );\r\n        callback(null, uniqueNeighborhoods);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Fetch all cuisines with proper error handling.\r\n   */\r\n  static fetchCuisines(callback) {\r\n    // Fetch all restaurants\r\n    DBHelper.fetchRestaurants((error, restaurants) => {\r\n      if (error) {\r\n        callback(error, null);\r\n      } else {\r\n        // Get all cuisines from all restaurants\r\n        const cuisines = restaurants.map((v, i) => restaurants[i].cuisine_type);\r\n        // Remove duplicates from cuisines\r\n        const uniqueCuisines = cuisines.filter(\r\n          (v, i) => cuisines.indexOf(v) == i\r\n        );\r\n        callback(null, uniqueCuisines);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Restaurant page URL.\r\n   */\r\n  static urlForRestaurant(restaurant) {\r\n    return `./restaurant.html?id=${restaurant.id}`;\r\n  }\r\n\r\n  /**\r\n   * Restaurant image URL.\r\n   */\r\n  static imageUrlForRestaurant(restaurant) {\r\n    const url = `./img/${restaurant.photograph || restaurant.id}-medium.jpg`;\r\n\r\n    return url;\r\n  }\r\n\r\n  /**\r\n   * Restaurant srcset attribute for browser to decide best resolution. It uses restaurant.photograph\r\n   * and fallbacks to restaurant.id if former is missing.\r\n   */\r\n  static imageSrcsetForRestaurant(restaurant) {\r\n    const imageSrc = `./img/${restaurant.photograph || restaurant.id}`;\r\n    return `${imageSrc}-small.jpg 300w,\r\n            ${imageSrc}-medium.jpg 600w,\r\n            ${imageSrc}-large.jpg 800w`;\r\n  }\r\n\r\n  /**\r\n   * Restaurant sizes attribute so browser knows image sizes before deciding\r\n   * what image to download.\r\n   */\r\n  static imageSizesForRestaurant(restaurant) {\r\n    return `(max-width: 360px) 280px,\r\n            (max-width: 600px) 600px,\r\n            400px`;\r\n  }\r\n\r\n  static mapMarkerForRestaurant(restaurant, map) {\r\n    const marker = new google.maps.Marker({\r\n      position: restaurant.latlng,\r\n      title: restaurant.name,\r\n      url: DBHelper.urlForRestaurant(restaurant),\r\n      map: map,\r\n      animation: google.maps.Animation.DROP\r\n    });\r\n    return marker;\r\n  }\r\n}\r\n","import idb from \"idb\";\r\n\r\nconst dbPromise = {\r\n  // creation and updating of database happens here.\r\n  db: idb.open(\"restaurant-reviews-db\", 3, function (upgradeDb) {\r\n    switch (upgradeDb.oldVersion) {\r\n      case 0:\r\n        upgradeDb.createObjectStore(\"restaurants\", { keyPath: \"id\" });\r\n      case 1:\r\n        upgradeDb\r\n          .createObjectStore(\"reviews\", { keyPath: \"id\" })\r\n          .createIndex(\"restaurant_id\", \"restaurant_id\");\r\n      case 2:\r\n        upgradeDb\r\n          .createObjectStore(\"offline\", { autoIncrement: true, keyPath: \"id\" })\r\n          .createIndex(\"restaurant_id\", \"restaurant_id\");\r\n      case 3:\r\n        upgradeDb\r\n          .createObjectStore(\"offline-fav\", { autoIncrement: true, keyPath: \"id\" })\r\n          .createIndex(\"restaurant_id\", \"restaurant_id\");\r\n    }\r\n  }),\r\n\r\n  /**\r\n   * Save restaurant\r\n   */\r\n  putRestaurants(restaurants, forceUpdate = false) {\r\n    if (!restaurants.push) restaurants = [restaurants];\r\n    return this.db.then(db => {\r\n      const store = db\r\n        .transaction(\"restaurants\", \"readwrite\")\r\n        .objectStore(\"restaurants\");\r\n      Promise.all(\r\n        restaurants.map(apiRestaurant => {\r\n          return store.get(apiRestaurant.id).then(idbRestaurant => {\r\n            if (forceUpdate) return store.put(apiRestaurant);\r\n            if (\r\n              !idbRestaurant ||\r\n              new Date(apiRestaurant.updatedAt) >\r\n              new Date(idbRestaurant.updatedAt)\r\n            ) {\r\n              return store.put(apiRestaurant);\r\n            }\r\n          });\r\n        })\r\n      ).then(function () {\r\n        return store.complete;\r\n      });\r\n    });\r\n  },\r\n\r\n  putFavorite(id, boolean) {\r\n    return this.db\r\n      .then((db) => {\r\n        const store = db\r\n          .transaction(\"restaurants\", \"readwrite\")\r\n          .objectStore(\"restaurants\");\r\n\r\n        store.get(id)\r\n          .then((idbRestaurant) => {\r\n            idbRestaurant.is_favorite = boolean.toString();\r\n\r\n            store.put(idbRestaurant);\r\n\r\n            return store.complete;\r\n          })\r\n      }).then(() => {\r\n        console.info('Updated fav in idb');\r\n      }).catch((err) => {\r\n        console.error('Error updating fav in idb', err);\r\n      })\r\n  },\r\n\r\n  /**\r\n   * Get restaurant\r\n   */\r\n  getRestaurants(id = undefined) {\r\n    return this.db.then(db => {\r\n      const store = db.transaction(\"restaurants\").objectStore(\"restaurants\");\r\n      if (id) return store.get(Number(id));\r\n      return store.getAll();\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Save reviews\r\n   */\r\n  putReviews(reviews) {\r\n    if (!reviews.push) reviews = [reviews];\r\n    return this.db.then(db => {\r\n      const store = db\r\n        .transaction(\"reviews\", \"readwrite\")\r\n        .objectStore(\"reviews\");\r\n      Promise.all(\r\n        reviews.map(apiReview => {\r\n          return store.get(apiReview.id).then(idbReview => {\r\n            if (\r\n              !idbReview ||\r\n              new Date(apiReview.updatedAt) > new Date(idbReview.updatedAt)\r\n            ) {\r\n              return store.put(apiReview);\r\n            }\r\n          });\r\n        })\r\n      ).then(function () {\r\n        return store.complete;\r\n      });\r\n    });\r\n  },\r\n\r\n  getReviewsForRestaurant(id) {\r\n    return this.db.then(db => {\r\n      const storeIndex = db\r\n        .transaction(\"reviews\")\r\n        .objectStore(\"reviews\")\r\n        .index(\"restaurant_id\");\r\n      return storeIndex.getAll(Number(id));\r\n    });\r\n  },\r\n\r\n  // Storing offline reviews to offline idb collection\r\n  putOfflineReview(review) {\r\n    return this.db\r\n      .then(db => {\r\n        const store = db.transaction(\"offline\", \"readwrite\").objectStore(\"offline\");\r\n        store.put(review);\r\n\r\n        return store.complete;\r\n      })\r\n      .then(() => {\r\n        console.info('Saved a review to idb while offline');\r\n        // navigator.serviceWorker.ready.then(registration => {\r\n        //   return registration.sync.register(\"flush\");\r\n        // });\r\n      });\r\n  },\r\n\r\n  // Getting whatever I have in the offline idb collection\r\n  getOfflineReviews() {\r\n    return this.db\r\n      .then(db => {\r\n        const store = db.transaction(\"offline\", \"readonly\").objectStore(\"offline\");\r\n\r\n        return store.getAll();\r\n      })\r\n      .then(() => {\r\n        console.info('Retrieved offline reviews');\r\n      });\r\n  },\r\n\r\n  // Clearing whatever I have in the offline idb collection\r\n  clearOfflineReviews() {\r\n    return this.db\r\n      .then(db => {\r\n        const store = db.transaction(\"offline\", \"readwrite\").objectStore(\"offline\");\r\n        store.clear();\r\n\r\n        return store;\r\n      })\r\n      .then((res) => {\r\n        console.warning('Deleted offline reviews', res);\r\n      });\r\n  },\r\n\r\n  // Storing offline favs to offline idb collection\r\n  putOfflinefav(fav) {\r\n    return this.db\r\n      .then(db => {\r\n        const store = db.transaction(\"offline-fav\", \"readwrite\").objectStore(\"offline-fav\");\r\n        store.put(fav);\r\n\r\n        return store.complete;\r\n      })\r\n      .then(() => {\r\n        console.info('Saved a fav to idb while offline');\r\n        // navigator.serviceWorker.ready.then(registration => {\r\n        //   return registration.sync.register(\"flush\");\r\n        // });\r\n      });\r\n  },\r\n\r\n  // Getting whatever I have in the offline idb collection\r\n  getOfflinefavs() {\r\n    return this.db\r\n      .then(db => {\r\n        const store = db.transaction(\"offline-fav\", \"readonly\").objectStore(\"offline-fav\");\r\n\r\n        return store.getAll();\r\n      })\r\n      .then(() => {\r\n        console.info('Retrieved offline favs');\r\n      });\r\n  },\r\n\r\n  // Clearing whatever I have in the offline idb collection\r\n  clearOfflinefavs() {\r\n    return this.db\r\n      .then(db => {\r\n        const store = db.transaction(\"offline-fav\", \"readwrite\").objectStore(\"offline-fav\");\r\n        store.clear();\r\n\r\n        return store;\r\n      })\r\n      .then((res) => {\r\n        console.warning('Deleted offline favs', res);\r\n      });\r\n  },\r\n\r\n};\r\n\r\nexport default dbPromise;\r\n","const { serviceWorker } = navigator;\r\n\r\nconst registerServiceWorker = () => {\r\n  if (\"serviceWorker\" in navigator) {\r\n    serviceWorker\r\n      .register(\"./sw.js\", { scope: \"./\" })\r\n      .then(registration => {\r\n        console.info(\"Service worker registered\", registration.scope);\r\n        const sw = {};\r\n\r\n        if (registration.installing) {\r\n          sw.status = registration.installing;\r\n          console.info(\"Service worker installing\");\r\n        }\r\n\r\n        if (registration.waiting) {\r\n          sw.status = registration.waiting;\r\n          console.warn(\"Service worker waiting\");\r\n        }\r\n\r\n        if (registration.active) {\r\n          sw.status = registration.active;\r\n          console.info(\"Service worker active\");\r\n        }\r\n\r\n        if ('sync' in  registration) {\r\n            console.info(\"Sync active\");\r\n          }\r\n\r\n        if (sw.status) {\r\n          console.log(\"Service worker state:\", sw.status.state);\r\n          sw.status.addEventListener(\"statechange\", e => {\r\n            console.log(\"Service worker state:\", e.target.state);\r\n          });\r\n        }\r\n        return null;\r\n      })\r\n      .catch(err => {\r\n        console.error(\"Service worker installation failed\", err);\r\n        // loadPage();\r\n      });\r\n  }\r\n\r\n  // If you end up here serviceworker is not supported\r\n  //loadPage();\r\n};\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", event => {\r\n  registerServiceWorker();\r\n});\r\n","'use-strict';\r\n\r\nimport DBHelper from './dbhelper';\r\nimport './register';\r\nimport './browser';\r\nimport reviewForm from './reviewform';\r\n\r\n\r\nlet restaurant = '';\r\nvar newMap;\r\n\r\n/**\r\n * Initialize map if you look at the script imported google runs init\r\n */\r\nwindow.initMap = () => {\r\n  fetchRestaurantFromURL((error, restaurant) => {\r\n    if (error) { // Got an error!\r\n      console.error(error);\r\n    } else {\r\n      newMap = new google.maps.Map(document.getElementById('detail-map'), {\r\n        zoom: 16,\r\n        center: restaurant.latlng,\r\n        scrollwheel: false\r\n      });\r\n      fillBreadcrumb();\r\n      DBHelper.mapMarkerForRestaurant(self.restaurant, newMap);\r\n    }\r\n  // Google map makes a bunch of links that steal focus of a screen reader\r\n  // Going to add an event that sets attribute to all of these items\r\n  const mapEl = document.getElementById('detail-map');\r\n  mapEl.addEventListener(\"keydown\", () => {\r\n  const mapLinks = mapEl.querySelectorAll('a');\r\n  mapLinks.forEach(link => link.setAttribute('tabindex', '-1'));\r\n});\r\n  \r\n  });\r\n}\r\n\r\n/**\r\n * Get current restaurant from page URL.\r\n */\r\nconst fetchRestaurantFromURL = (callback) => {\r\n  if (self.restaurant) { // restaurant already fetched!\r\n    callback(null, self.restaurant)\r\n    return;\r\n  }\r\n  const id = getParameterByName('id');\r\n  if (!id) { // no id found in URL\r\n    error = 'No restaurant id in URL'\r\n    callback(error, null);\r\n  } else {\r\n    DBHelper.fetchRestaurantById(id, (error, restaurant) => {\r\n      self.restaurant = restaurant;\r\n      if (!restaurant) {\r\n        console.error(error);\r\n        return;\r\n      }\r\n      fillRestaurantHTML();\r\n      callback(null, restaurant)\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * Create restaurant HTML and add it to the webpage\r\n */\r\nconst fillRestaurantHTML = (restaurant = self.restaurant) => {\r\n  const name = document.getElementById('restaurant-name');\r\n  name.innerHTML = restaurant.name;\r\n\r\n  // const favButtonContainer = document.getElementById('fav-button-container');\r\n  // favButtonContainer.appendChild(favoriteButton(restaurant));\r\n  // favButtonContainer.alt = `Save ${restaurant.name} as a favorite`;\r\n\r\n  const address = document.getElementById('restaurant-address');\r\n  address.innerHTML = restaurant.address;\r\n\r\n  const image = document.getElementById('restaurant-img');\r\n  image.className = 'restaurant-img';\r\n  image.classList.add = 'lazyload';\r\n  image.src = DBHelper.imageUrlForRestaurant(restaurant);\r\n  image.srcset = DBHelper.imageSrcsetForRestaurant(restaurant);\r\n  image.sizes = DBHelper.imageSizesForRestaurant(restaurant);\r\n  image.alt = `${restaurant.name} promotional image`;\r\n\r\n  const cuisine = document.getElementById('restaurant-cuisine');\r\n  cuisine.innerHTML = restaurant.cuisine_type;\r\n\r\n  // fill operating hours\r\n  if (restaurant.operating_hours) {\r\n    fillRestaurantHoursHTML();\r\n  }\r\n  // fill reviews\r\n  DBHelper.fetchsReviewsByRestaurantId(restaurant.id)\r\n  .then((reviews) => fillReviewsHTML(reviews));\r\n}\r\n\r\n/**\r\n * Create restaurant operating hours HTML table and add it to the webpage.\r\n */\r\nconst fillRestaurantHoursHTML = (operatingHours = self.restaurant.operating_hours) => {\r\n  const hours = document.getElementById('restaurant-hours');\r\n  for (let key in operatingHours) {\r\n    const row = document.createElement('tr');\r\n\r\n    const day = document.createElement('td');\r\n    day.innerHTML = key;\r\n    row.appendChild(day);\r\n\r\n    const time = document.createElement('td');\r\n    time.innerHTML = operatingHours[key];\r\n    row.appendChild(time);\r\n    hours.setAttribute('tabindex', '0');\r\n    hours.setAttribute('aria-label', `Hours of operation for ${self.restaurant.name}`)\r\n    hours.appendChild(row);\r\n  }\r\n}\r\n\r\n/**\r\n * Create all reviews HTML and add them to the webpage.\r\n */\r\nconst fillReviewsHTML = (reviews = self.restaurant.reviews) => {\r\n  const container = document.getElementById('reviews-container');\r\n  const title = document.createElement('h3');\r\n  title.innerHTML = 'Reviews';\r\n  container.appendChild(title);\r\n\r\n  const list = document.createElement('div');\r\n  list.id = 'list-container';\r\n  container.appendChild(list);\r\n\r\n  const ul = document.createElement('ul');\r\n  ul.id = 'reviews-list';\r\n  ul.setAttribute('tabindex', '0');\r\n  ul.setAttribute('aria-label', `List of restaurant reviews for ${self.restaurant.name}`);\r\n  list.appendChild(ul);\r\n\r\n  if (!reviews) {\r\n    const noReviews = document.createElement('p');\r\n    noReviews.innerHTML = 'No reviews yet!';\r\n    noReviews.id = 'no-reviews';\r\n    container.appendChild(noReviews);\r\n\r\n  } else {\r\n    reviews.forEach(review => {\r\n      ul.appendChild(createReviewHTML(review));\r\n\r\n    });\r\n  }\r\n\r\n  const head = document.createElement('h3');\r\n  head.innerHTML = \"Leave a Review\";\r\n  container.appendChild(head);\r\n  const id = getParameterByName('id');\r\n  container.appendChild(reviewForm(id));\r\n}\r\n\r\n/**\r\n * Create review HTML and add it to the webpage.\r\n */\r\nconst createReviewHTML = (review) => {\r\n  const li = document.createElement('li');\r\n  const name = document.createElement('p');\r\n  name.innerHTML = review.name;\r\n  name.className = 'reviewer';\r\n  name.setAttribute('alt', 'Reviewer name');\r\n  li.appendChild(name);\r\n\r\n  const date = document.createElement('p');\r\n  date.innerHTML = new Date(review.createdAt).toLocaleDateString();\r\n  date.className = 'date';\r\n  date.setAttribute('alt', 'Date reviewed');\r\n  li.appendChild(date);\r\n\r\n  const rating = document.createElement('p');\r\n  rating.innerHTML = `Rating: ${review.rating}`;\r\n  rating.className = 'rating';\r\n  rating.setAttribute('alt', 'Rating given by reviewer');\r\n  li.appendChild(rating);\r\n\r\n  const comments = document.createElement('p');\r\n  comments.innerHTML = review.comments;\r\n  comments.className = 'comments';\r\n  comments.setAttribute('alt', 'Comments written by reviewer');\r\n  li.appendChild(comments);\r\n\r\n  return li;\r\n}\r\n\r\n/**\r\n * Add restaurant name to the breadcrumb navigation menu\r\n */\r\nconst fillBreadcrumb = (restaurant=self.restaurant) => {\r\n  const breadcrumb = document.getElementById('breadcrumb');\r\n  const li = document.createElement('li');\r\n  li.innerHTML = restaurant.name;\r\n  breadcrumb.appendChild(li);\r\n}\r\n\r\n/**\r\n * Get a parameter by name from page URL.\r\n */\r\nconst getParameterByName = (name, url) => {\r\n  if (!url)\r\n    url = window.location.href;\r\n  name = name.replace(/[\\[\\]]/g, '\\\\$&');\r\n  const regex = new RegExp(`[?&]${name}(=([^&#]*)|&|#|$)`),\r\n    results = regex.exec(url);\r\n  if (!results)\r\n    return null;\r\n  if (!results[2])\r\n    return '';\r\n  return decodeURIComponent(results[2].replace(/\\+/g, ' '));\r\n}\r\n","import DBHelper from \"./dbhelper\";\r\nimport dbPromise from \"./dbpromise\";\r\n\r\n/**\r\n * Returns a li element with review data so it can be appended to\r\n * the review list.\r\n */\r\nfunction createReviewHTML(review) {\r\n  const li = document.createElement(\"li\");\r\n  const reviewer = document.createElement(\"p\");\r\n  reviewer.innerHTML = reviewer.name;\r\n  reviewer.className = 'reviewer';\r\n  reviewer.setAttribute('alt', 'Reviewer name');\r\n  li.appendChild(reviewer);\r\n\r\n  const date = document.createElement(\"p\");\r\n  date.innerHTML = new Date(review.createdAt).toLocaleDateString();\r\n  date.className = 'date';\r\n  date.setAttribute('alt', 'Date reviewed');\r\n  li.appendChild(date);\r\n\r\n  const rating = document.createElement(\"p\");\r\n  rating.innerHTML = `Rating: ${review.rating}`;\r\n  rating.className = 'rating';\r\n  rating.setAttribute('alt', 'Rating given by reviewer');\r\n  li.appendChild(rating);\r\n\r\n  const comments = document.createElement(\"p\");\r\n  comments.innerHTML = review.comments;\r\n  comments.className = 'comments';\r\n  comments.setAttribute('alt', 'Comments written by reviewer');\r\n  li.appendChild(comments);\r\n\r\n  return li;\r\n}\r\n\r\n/**\r\n * Clear form data\r\n */\r\nfunction clearForm() {\r\n  // clear form data\r\n  document.getElementById(\"name\").value = \"\";\r\n  document.getElementById(\"rating\").selectedIndex = 0;\r\n  document.getElementById(\"comments\").value = \"\";\r\n}\r\n\r\n/**\r\n * Remove no review element\r\n */\r\nfunction removeNoReviews() {\r\n  const noReviews = document.getElementById(\"no-reviews\");\r\n  \r\n  if(noReviews) noReviews.remove();\r\n\r\n}\r\n\r\n/**\r\n * Make sure all form fields have a value and return data in\r\n * an object, so is ready for a POST request.\r\n */\r\nfunction validateAndGetData() {\r\n  const data = {};\r\n\r\n  // get name\r\n  let name = document.getElementById(\"name\");\r\n  if (name.value === \"\") {\r\n    name.focus();\r\n    return;\r\n  }\r\n  data.name = name.value;\r\n\r\n  // get rating\r\n  const ratingSelect = document.getElementById(\"rating\");\r\n  const rating = ratingSelect.options[ratingSelect.selectedIndex].value;\r\n  if (rating == \"--\") {\r\n    ratingSelect.focus();\r\n    return;\r\n  }\r\n  data.rating = Number(rating);\r\n\r\n  // get comments\r\n  let comments = document.getElementById(\"comments\");\r\n  if (comments.value === \"\") {\r\n    comments.focus();\r\n    return;\r\n  }\r\n  data.comments = comments.value;\r\n\r\n  // get restaurant_id\r\n  let restaurantId = document.getElementById(\"review-form\").dataset\r\n    .restaurantId;\r\n  data.restaurant_id = Number(restaurantId);\r\n  data.createdAt = new Date().toISOString();\r\n\r\n  return data;\r\n}\r\n\r\n\r\n\r\n/**\r\n * Grab the review and send it to the dom, while you are at it clear the no reviews el, and clear form\r\n */\r\nfunction insertReviewAndClear(review) {\r\n  // post new review on page\r\n  const reviewList = document.getElementById(\"reviews-list\");\r\n  const reviewEl = createReviewHTML(review);\r\n  reviewList.appendChild(reviewEl);\r\n  //remove noReviews element\r\n  removeNoReviews();\r\n\r\n  // clear form\r\n  clearForm();\r\n}\r\n\r\n/**\r\n * Handle submit.\r\n */\r\nfunction handleSubmit(e) {\r\n  e.preventDefault();\r\n  const review = validateAndGetData();\r\n  const url = `${DBHelper.API_URL}/reviews/`;\r\n  const POST = {\r\n    method: \"POST\",\r\n    body: JSON.stringify(review)\r\n  };\r\n\r\n  // If we are offline\r\n  if(!navigator.onLine) {\r\n    console.info('App was offline, when you tried to send review');\r\n    \r\n    dbPromise.putOfflineReview(review, \"review\");\r\n    insertReviewAndClear(review);\r\n\r\n  }\r\n  // If we are online\r\n  return fetch(url, POST)\r\n    .then(response => {\r\n      if (!response.ok) {\r\n        return Promise.reject(\"We couldn't post review to server.\");\r\n      }\r\n      return response.json();\r\n    }).catch((err) => {\r\n      console.info('Disconnected when submitted form');\r\n    })\r\n    .then(apiReview => {\r\n      insertReviewAndClear(apiReview)\r\n    })\r\n}\r\n\r\n/**\r\n * Returns a form element for posting new reviews.\r\n */\r\nexport default function reviewForm(restaurantId) {\r\n  const form = document.createElement(\"form\");\r\n  form.id = \"review-form\";\r\n  form.dataset.restaurantId = restaurantId;\r\n\r\n  let p = document.createElement(\"p\");\r\n  const name = document.createElement(\"input\");\r\n  name.id = \"name\";\r\n  name.setAttribute(\"type\", \"text\");\r\n  name.setAttribute(\"aria-label\", \"Name\");\r\n  name.setAttribute(\"placeholder\", \"Name\");\r\n  p.appendChild(name);\r\n  form.appendChild(p);\r\n\r\n  p = document.createElement(\"p\");\r\n  const selectLabel = document.createElement(\"label\");\r\n  selectLabel.setAttribute(\"for\", \"rating\");\r\n  selectLabel.innerText = \"Your rating: \";\r\n  p.appendChild(selectLabel);\r\n  const select = document.createElement(\"select\");\r\n  select.id = \"rating\";\r\n  select.name = \"rating\";\r\n  select.classList.add(\"rating\");\r\n  [\"--\", 1, 2, 3, 4, 5].forEach(number => {\r\n    const option = document.createElement(\"option\");\r\n    option.value = number;\r\n    option.innerHTML = number;\r\n    if (number === \"--\") option.selected = true;\r\n    select.appendChild(option);\r\n  });\r\n  p.appendChild(select);\r\n  form.appendChild(p);\r\n\r\n  p = document.createElement(\"p\");\r\n  const textarea = document.createElement(\"textarea\");\r\n  textarea.id = \"comments\";\r\n  textarea.setAttribute(\"aria-label\", \"comments\");\r\n  textarea.setAttribute(\"placeholder\", \"Enter any comments here\");\r\n  textarea.setAttribute(\"rows\", \"10\");\r\n  p.appendChild(textarea);\r\n  form.appendChild(p);\r\n\r\n  p = document.createElement(\"p\");\r\n  const addButton = document.createElement(\"button\");\r\n  addButton.setAttribute(\"type\", \"submit\");\r\n  addButton.setAttribute(\"aria-label\", \"Add Review\");\r\n  addButton.classList.add(\"add-review\");\r\n  addButton.innerHTML = \"<span>+</span>\";\r\n  p.appendChild(addButton);\r\n  form.appendChild(p);\r\n\r\n  form.onsubmit = handleSubmit;\r\n\r\n  return form;\r\n}\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvaWRiL2xpYi9pZGIuanMiLCJzcmMvanMvYnJvd3Nlci5qcyIsInNyYy9qcy9kYmhlbHBlci5qcyIsInNyYy9qcy9kYnByb21pc2UuanMiLCJzcmMvanMvcmVnaXN0ZXIuanMiLCJzcmMvanMvcmVzdGF1cmFudF9pbmZvLmpzIiwic3JjL2pzL3Jldmlld2Zvcm0uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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dCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiJ3VzZSBzdHJpY3QnO1xuXG4oZnVuY3Rpb24oKSB7XG4gIGZ1bmN0aW9uIHRvQXJyYXkoYXJyKSB7XG4gICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFycik7XG4gIH1cblxuICBmdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXNvbHZlKHJlcXVlc3QucmVzdWx0KTtcbiAgICAgIH07XG5cbiAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QocmVxdWVzdC5lcnJvcik7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpIHtcbiAgICB2YXIgcmVxdWVzdDtcbiAgICB2YXIgcCA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgcmVxdWVzdCA9IG9ialttZXRob2RdLmFwcGx5KG9iaiwgYXJncyk7XG4gICAgICBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcbiAgICB9KTtcblxuICAgIHAucmVxdWVzdCA9IHJlcXVlc3Q7XG4gICAgcmV0dXJuIHA7XG4gIH1cblxuICBmdW5jdGlvbiBwcm9taXNpZnlDdXJzb3JSZXF1ZXN0Q2FsbChvYmosIG1ldGhvZCwgYXJncykge1xuICAgIHZhciBwID0gcHJvbWlzaWZ5UmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpO1xuICAgIHJldHVybiBwLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgIGlmICghdmFsdWUpIHJldHVybjtcbiAgICAgIHJldHVybiBuZXcgQ3Vyc29yKHZhbHVlLCBwLnJlcXVlc3QpO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJveHlQcm9wZXJ0aWVzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIHByb3BlcnRpZXMpIHtcbiAgICBwcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24ocHJvcCkge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFByb3h5Q2xhc3MucHJvdG90eXBlLCBwcm9wLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF07XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24odmFsKSB7XG4gICAgICAgICAgdGhpc1t0YXJnZXRQcm9wXVtwcm9wXSA9IHZhbDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eVJlcXVlc3RNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuICAgICAgUHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3RDYWxsKHRoaXNbdGFyZ2V0UHJvcF0sIHByb3AsIGFyZ3VtZW50cyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJveHlNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuICAgICAgUHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF0uYXBwbHkodGhpc1t0YXJnZXRQcm9wXSwgYXJndW1lbnRzKTtcbiAgICAgIH07XG4gICAgfSk7XG4gIH1cblxuICBmdW5jdGlvbiBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKFByb3h5Q2xhc3MsIHRhcmdldFByb3AsIENvbnN0cnVjdG9yLCBwcm9wZXJ0aWVzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcbiAgICAgIGlmICghKHByb3AgaW4gQ29uc3RydWN0b3IucHJvdG90eXBlKSkgcmV0dXJuO1xuICAgICAgUHJveHlDbGFzcy5wcm90b3R5cGVbcHJvcF0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeUN1cnNvclJlcXVlc3RDYWxsKHRoaXNbdGFyZ2V0UHJvcF0sIHByb3AsIGFyZ3VtZW50cyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gSW5kZXgoaW5kZXgpIHtcbiAgICB0aGlzLl9pbmRleCA9IGluZGV4O1xuICB9XG5cbiAgcHJveHlQcm9wZXJ0aWVzKEluZGV4LCAnX2luZGV4JywgW1xuICAgICduYW1lJyxcbiAgICAna2V5UGF0aCcsXG4gICAgJ211bHRpRW50cnknLFxuICAgICd1bmlxdWUnXG4gIF0pO1xuXG4gIHByb3h5UmVxdWVzdE1ldGhvZHMoSW5kZXgsICdfaW5kZXgnLCBJREJJbmRleCwgW1xuICAgICdnZXQnLFxuICAgICdnZXRLZXknLFxuICAgICdnZXRBbGwnLFxuICAgICdnZXRBbGxLZXlzJyxcbiAgICAnY291bnQnXG4gIF0pO1xuXG4gIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoSW5kZXgsICdfaW5kZXgnLCBJREJJbmRleCwgW1xuICAgICdvcGVuQ3Vyc29yJyxcbiAgICAnb3BlbktleUN1cnNvcidcbiAgXSk7XG5cbiAgZnVuY3Rpb24gQ3Vyc29yKGN1cnNvciwgcmVxdWVzdCkge1xuICAgIHRoaXMuX2N1cnNvciA9IGN1cnNvcjtcbiAgICB0aGlzLl9yZXF1ZXN0ID0gcmVxdWVzdDtcbiAgfVxuXG4gIHByb3h5UHJvcGVydGllcyhDdXJzb3IsICdfY3Vyc29yJywgW1xuICAgICdkaXJlY3Rpb24nLFxuICAgICdrZXknLFxuICAgICdwcmltYXJ5S2V5JyxcbiAgICAndmFsdWUnXG4gIF0pO1xuXG4gIHByb3h5UmVxdWVzdE1ldGhvZHMoQ3Vyc29yLCAnX2N1cnNvcicsIElEQkN1cnNvciwgW1xuICAgICd1cGRhdGUnLFxuICAgICdkZWxldGUnXG4gIF0pO1xuXG4gIC8vIHByb3h5ICduZXh0JyBtZXRob2RzXG4gIFsnYWR2YW5jZScsICdjb250aW51ZScsICdjb250aW51ZVByaW1hcnlLZXknXS5mb3JFYWNoKGZ1bmN0aW9uKG1ldGhvZE5hbWUpIHtcbiAgICBpZiAoIShtZXRob2ROYW1lIGluIElEQkN1cnNvci5wcm90b3R5cGUpKSByZXR1cm47XG4gICAgQ3Vyc29yLnByb3RvdHlwZVttZXRob2ROYW1lXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGN1cnNvciA9IHRoaXM7XG4gICAgICB2YXIgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBjdXJzb3IuX2N1cnNvclttZXRob2ROYW1lXS5hcHBseShjdXJzb3IuX2N1cnNvciwgYXJncyk7XG4gICAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0KGN1cnNvci5fcmVxdWVzdCkudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuICAgICAgICAgIGlmICghdmFsdWUpIHJldHVybjtcbiAgICAgICAgICByZXR1cm4gbmV3IEN1cnNvcih2YWx1ZSwgY3Vyc29yLl9yZXF1ZXN0KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICB9KTtcblxuICBmdW5jdGlvbiBPYmplY3RTdG9yZShzdG9yZSkge1xuICAgIHRoaXMuX3N0b3JlID0gc3RvcmU7XG4gIH1cblxuICBPYmplY3RTdG9yZS5wcm90b3R5cGUuY3JlYXRlSW5kZXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IEluZGV4KHRoaXMuX3N0b3JlLmNyZWF0ZUluZGV4LmFwcGx5KHRoaXMuX3N0b3JlLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBPYmplY3RTdG9yZS5wcm90b3R5cGUuaW5kZXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IEluZGV4KHRoaXMuX3N0b3JlLmluZGV4LmFwcGx5KHRoaXMuX3N0b3JlLCBhcmd1bWVudHMpKTtcbiAgfTtcblxuICBwcm94eVByb3BlcnRpZXMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBbXG4gICAgJ25hbWUnLFxuICAgICdrZXlQYXRoJyxcbiAgICAnaW5kZXhOYW1lcycsXG4gICAgJ2F1dG9JbmNyZW1lbnQnXG4gIF0pO1xuXG4gIHByb3h5UmVxdWVzdE1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuICAgICdwdXQnLFxuICAgICdhZGQnLFxuICAgICdkZWxldGUnLFxuICAgICdjbGVhcicsXG4gICAgJ2dldCcsXG4gICAgJ2dldEFsbCcsXG4gICAgJ2dldEtleScsXG4gICAgJ2dldEFsbEtleXMnLFxuICAgICdjb3VudCdcbiAgXSk7XG5cbiAgcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhPYmplY3RTdG9yZSwgJ19zdG9yZScsIElEQk9iamVjdFN0b3JlLCBbXG4gICAgJ29wZW5DdXJzb3InLFxuICAgICdvcGVuS2V5Q3Vyc29yJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuICAgICdkZWxldGVJbmRleCdcbiAgXSk7XG5cbiAgZnVuY3Rpb24gVHJhbnNhY3Rpb24oaWRiVHJhbnNhY3Rpb24pIHtcbiAgICB0aGlzLl90eCA9IGlkYlRyYW5zYWN0aW9uO1xuICAgIHRoaXMuY29tcGxldGUgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIGlkYlRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgfTtcbiAgICAgIGlkYlRyYW5zYWN0aW9uLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KGlkYlRyYW5zYWN0aW9uLmVycm9yKTtcbiAgICAgIH07XG4gICAgICBpZGJUcmFuc2FjdGlvbi5vbmFib3J0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChpZGJUcmFuc2FjdGlvbi5lcnJvcik7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgVHJhbnNhY3Rpb24ucHJvdG90eXBlLm9iamVjdFN0b3JlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBPYmplY3RTdG9yZSh0aGlzLl90eC5vYmplY3RTdG9yZS5hcHBseSh0aGlzLl90eCwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgcHJveHlQcm9wZXJ0aWVzKFRyYW5zYWN0aW9uLCAnX3R4JywgW1xuICAgICdvYmplY3RTdG9yZU5hbWVzJyxcbiAgICAnbW9kZSdcbiAgXSk7XG5cbiAgcHJveHlNZXRob2RzKFRyYW5zYWN0aW9uLCAnX3R4JywgSURCVHJhbnNhY3Rpb24sIFtcbiAgICAnYWJvcnQnXG4gIF0pO1xuXG4gIGZ1bmN0aW9uIFVwZ3JhZGVEQihkYiwgb2xkVmVyc2lvbiwgdHJhbnNhY3Rpb24pIHtcbiAgICB0aGlzLl9kYiA9IGRiO1xuICAgIHRoaXMub2xkVmVyc2lvbiA9IG9sZFZlcnNpb247XG4gICAgdGhpcy50cmFuc2FjdGlvbiA9IG5ldyBUcmFuc2FjdGlvbih0cmFuc2FjdGlvbik7XG4gIH1cblxuICBVcGdyYWRlREIucHJvdG90eXBlLmNyZWF0ZU9iamVjdFN0b3JlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBPYmplY3RTdG9yZSh0aGlzLl9kYi5jcmVhdGVPYmplY3RTdG9yZS5hcHBseSh0aGlzLl9kYiwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgcHJveHlQcm9wZXJ0aWVzKFVwZ3JhZGVEQiwgJ19kYicsIFtcbiAgICAnbmFtZScsXG4gICAgJ3ZlcnNpb24nLFxuICAgICdvYmplY3RTdG9yZU5hbWVzJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoVXBncmFkZURCLCAnX2RiJywgSURCRGF0YWJhc2UsIFtcbiAgICAnZGVsZXRlT2JqZWN0U3RvcmUnLFxuICAgICdjbG9zZSdcbiAgXSk7XG5cbiAgZnVuY3Rpb24gREIoZGIpIHtcbiAgICB0aGlzLl9kYiA9IGRiO1xuICB9XG5cbiAgREIucHJvdG90eXBlLnRyYW5zYWN0aW9uID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBUcmFuc2FjdGlvbih0aGlzLl9kYi50cmFuc2FjdGlvbi5hcHBseSh0aGlzLl9kYiwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgcHJveHlQcm9wZXJ0aWVzKERCLCAnX2RiJywgW1xuICAgICduYW1lJyxcbiAgICAndmVyc2lvbicsXG4gICAgJ29iamVjdFN0b3JlTmFtZXMnXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhEQiwgJ19kYicsIElEQkRhdGFiYXNlLCBbXG4gICAgJ2Nsb3NlJ1xuICBdKTtcblxuICAvLyBBZGQgY3Vyc29yIGl0ZXJhdG9yc1xuICAvLyBUT0RPOiByZW1vdmUgdGhpcyBvbmNlIGJyb3dzZXJzIGRvIHRoZSByaWdodCB0aGluZyB3aXRoIHByb21pc2VzXG4gIFsnb3BlbkN1cnNvcicsICdvcGVuS2V5Q3Vyc29yJ10uZm9yRWFjaChmdW5jdGlvbihmdW5jTmFtZSkge1xuICAgIFtPYmplY3RTdG9yZSwgSW5kZXhdLmZvckVhY2goZnVuY3Rpb24oQ29uc3RydWN0b3IpIHtcbiAgICAgIC8vIERvbid0IGNyZWF0ZSBpdGVyYXRlS2V5Q3Vyc29yIGlmIG9wZW5LZXlDdXJzb3IgZG9lc24ndCBleGlzdC5cbiAgICAgIGlmICghKGZ1bmNOYW1lIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcblxuICAgICAgQ29uc3RydWN0b3IucHJvdG90eXBlW2Z1bmNOYW1lLnJlcGxhY2UoJ29wZW4nLCAnaXRlcmF0ZScpXSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgYXJncyA9IHRvQXJyYXkoYXJndW1lbnRzKTtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gYXJnc1thcmdzLmxlbmd0aCAtIDFdO1xuICAgICAgICB2YXIgbmF0aXZlT2JqZWN0ID0gdGhpcy5fc3RvcmUgfHwgdGhpcy5faW5kZXg7XG4gICAgICAgIHZhciByZXF1ZXN0ID0gbmF0aXZlT2JqZWN0W2Z1bmNOYW1lXS5hcHBseShuYXRpdmVPYmplY3QsIGFyZ3Muc2xpY2UoMCwgLTEpKTtcbiAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBjYWxsYmFjayhyZXF1ZXN0LnJlc3VsdCk7XG4gICAgICAgIH07XG4gICAgICB9O1xuICAgIH0pO1xuICB9KTtcblxuICAvLyBwb2x5ZmlsbCBnZXRBbGxcbiAgW0luZGV4LCBPYmplY3RTdG9yZV0uZm9yRWFjaChmdW5jdGlvbihDb25zdHJ1Y3Rvcikge1xuICAgIGlmIChDb25zdHJ1Y3Rvci5wcm90b3R5cGUuZ2V0QWxsKSByZXR1cm47XG4gICAgQ29uc3RydWN0b3IucHJvdG90eXBlLmdldEFsbCA9IGZ1bmN0aW9uKHF1ZXJ5LCBjb3VudCkge1xuICAgICAgdmFyIGluc3RhbmNlID0gdGhpcztcbiAgICAgIHZhciBpdGVtcyA9IFtdO1xuXG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSkge1xuICAgICAgICBpbnN0YW5jZS5pdGVyYXRlQ3Vyc29yKHF1ZXJ5LCBmdW5jdGlvbihjdXJzb3IpIHtcbiAgICAgICAgICBpZiAoIWN1cnNvcikge1xuICAgICAgICAgICAgcmVzb2x2ZShpdGVtcyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGl0ZW1zLnB1c2goY3Vyc29yLnZhbHVlKTtcblxuICAgICAgICAgIGlmIChjb3VudCAhPT0gdW5kZWZpbmVkICYmIGl0ZW1zLmxlbmd0aCA9PSBjb3VudCkge1xuICAgICAgICAgICAgcmVzb2x2ZShpdGVtcyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGN1cnNvci5jb250aW51ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH07XG4gIH0pO1xuXG4gIHZhciBleHAgPSB7XG4gICAgb3BlbjogZnVuY3Rpb24obmFtZSwgdmVyc2lvbiwgdXBncmFkZUNhbGxiYWNrKSB7XG4gICAgICB2YXIgcCA9IHByb21pc2lmeVJlcXVlc3RDYWxsKGluZGV4ZWREQiwgJ29wZW4nLCBbbmFtZSwgdmVyc2lvbl0pO1xuICAgICAgdmFyIHJlcXVlc3QgPSBwLnJlcXVlc3Q7XG5cbiAgICAgIGlmIChyZXF1ZXN0KSB7XG4gICAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgICAgICBpZiAodXBncmFkZUNhbGxiYWNrKSB7XG4gICAgICAgICAgICB1cGdyYWRlQ2FsbGJhY2sobmV3IFVwZ3JhZGVEQihyZXF1ZXN0LnJlc3VsdCwgZXZlbnQub2xkVmVyc2lvbiwgcmVxdWVzdC50cmFuc2FjdGlvbikpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHAudGhlbihmdW5jdGlvbihkYikge1xuICAgICAgICByZXR1cm4gbmV3IERCKGRiKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZGVsZXRlOiBmdW5jdGlvbihuYW1lKSB7XG4gICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdENhbGwoaW5kZXhlZERCLCAnZGVsZXRlRGF0YWJhc2UnLCBbbmFtZV0pO1xuICAgIH1cbiAgfTtcblxuICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGV4cDtcbiAgICBtb2R1bGUuZXhwb3J0cy5kZWZhdWx0ID0gbW9kdWxlLmV4cG9ydHM7XG4gIH1cbiAgZWxzZSB7XG4gICAgc2VsZi5pZGIgPSBleHA7XG4gIH1cbn0oKSk7XG4iLCJsZXQgdXNlcnNCcm93c2VyO1xyXG5jb25zdCB7IHVzZXJBZ2VudCB9ID0gbmF2aWdhdG9yO1xyXG5cclxuLy8gVGhlIG9yZGVyIG1hdHRlcnMgaGVyZSwgYW5kIHRoaXMgbWF5IHJlcG9ydCBmYWxzZSBwb3NpdGl2ZXMgZm9yIHVubGlzdGVkIGJyb3dzZXJzLlxyXG5pZiAodXNlckFnZW50LmluZGV4T2YoJ0ZpcmVmb3gnKSA+IC0xKSB7XHJcbiAgICB1c2Vyc0Jyb3dzZXIgPSAnTW96aWxsYSBGaXJlZm94JztcclxufSBlbHNlIGlmICh1c2VyQWdlbnQuaW5kZXhPZignT3BlcmEnKSA+IC0xKSB7XHJcbiAgICB1c2Vyc0Jyb3dzZXIgPSAnT3BlcmEnO1xyXG59IGVsc2UgaWYgKHVzZXJBZ2VudC5pbmRleE9mKCdUcmlkZW50JykgPiAtMSkge1xyXG4gICAgdXNlcnNCcm93c2VyID0gJ01pY3Jvc29mdCBJbnRlcm5ldCBFeHBsb3Jlcic7XHJcbn0gZWxzZSBpZiAodXNlckFnZW50LmluZGV4T2YoJ0VkZ2UnKSA+IC0xKSB7XHJcbiAgICB1c2Vyc0Jyb3dzZXIgPSAnTWljcm9zb2Z0IEVkZ2UnO1xyXG59IGVsc2UgaWYgKHVzZXJBZ2VudC5pbmRleE9mKCdDaHJvbWUnKSA+IC0xKSB7XHJcbiAgICB1c2Vyc0Jyb3dzZXIgPSAnR29vZ2xlIENocm9tZSBvciBDaHJvbWl1bSc7XHJcbn0gZWxzZSBpZiAodXNlckFnZW50LmluZGV4T2YoJ1NhZmFyaScpID4gLTEpIHtcclxuICAgIHVzZXJzQnJvd3NlciA9ICdBcHBsZSBTYWZhcmknO1xyXG59IGVsc2Uge1xyXG4gICAgdXNlcnNCcm93c2VyID0gJ3Vua25vd24nO1xyXG59XHJcblxyXG5jb25zb2xlLmxvZyhgWW91IGFyZSB1c2luZzogJHt1c2Vyc0Jyb3dzZXJ9YCk7XHJcbiIsImltcG9ydCBkYlByb21pc2UgZnJvbSBcIi4vZGJwcm9taXNlXCI7XHJcblxyXG4vKipcclxuICogQ29tbW9uIGRhdGFiYXNlIGhlbHBlciBmdW5jdGlvbnMuXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBEQkhlbHBlciB7XHJcbiAgLyoqXHJcbiAgICogQVBJIFVSTFxyXG4gICAqL1xyXG4gIHN0YXRpYyBnZXQgQVBJX1VSTCgpIHtcclxuICAgIGNvbnN0IHBvcnQgPSAxMzM3OyAvLyBwb3J0IHdoZXJlIHNhaWxzIHNlcnZlciB3aWxsIGxpc3Rlbi5cclxuXHJcbiAgICBjb25zdCBoZXJva3UgPSBcImh0dHBzOi8vd2lub3NhaWxzLmhlcm9rdWFwcC5jb21cIjtcclxuICAgIGNvbnN0IGlzTG9jYWxIb3N0ID0gKCkgPT4ge1xyXG4gICAgICBpZiAod2luZG93LmxvY2F0aW9uLmhvc3RuYW1lLmluY2x1ZGVzKFwibG9jYWxob3N0XCIpKSB7XHJcbiAgICAgICAgcmV0dXJuIGBodHRwOi8vbG9jYWxob3N0OiR7cG9ydH1gO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHVybCA9IGlzTG9jYWxIb3N0KCkgfHwgaGVyb2t1O1xyXG5cclxuICAgIHJldHVybiB1cmw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCBhbGwgcmVzdGF1cmFudHMuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoUmVzdGF1cmFudHMoY2FsbGJhY2spIHtcclxuICAgIHRoaXMuc3luY09mZmxpbmVmYXYoKVxyXG4gICAgbGV0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgeGhyLm9wZW4oXCJHRVRcIiwgYCR7REJIZWxwZXIuQVBJX1VSTH0vcmVzdGF1cmFudHNgKTtcclxuICAgIHhoci5vbmxvYWQgPSAoKSA9PiB7XHJcbiAgICAgIGlmICh4aHIuc3RhdHVzID09PSAyMDApIHtcclxuICAgICAgICBjb25zdCByZXN0YXVyYW50cyA9IEpTT04ucGFyc2UoeGhyLnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgZGJQcm9taXNlLnB1dFJlc3RhdXJhbnRzKHJlc3RhdXJhbnRzKTtcclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50cyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gT29wcyEuIEdvdCBhbiBlcnJvciBmcm9tIHNlcnZlci5cclxuICAgICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICAgIGBSZXF1ZXN0IGZhaWxlZC4gUmV0dXJuZWQgc3RhdHVzIG9mICR7eGhyLnN0YXR1c30sIHRyeWluZyBpZGIuLi5gXHJcbiAgICAgICAgKTtcclxuICAgICAgICAvLyBpZiB4aHIgcmVxdWVzdCBpc24ndCBjb2RlIDIwMCwgdHJ5IGlkYlxyXG4gICAgICAgIGRiUHJvbWlzZS5nZXRSZXN0YXVyYW50cygpLnRoZW4oaWRiUmVzdGF1cmFudHMgPT4ge1xyXG4gICAgICAgICAgaWYgKGlkYlJlc3RhdXJhbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBjYWxsYmFjayhudWxsLCBpZGJSZXN0YXVyYW50cyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjYWxsYmFjayhcIk5vIHJlc3RhdXJhbnRzIGZvdW5kIGluIGlkYlwiLCBudWxsKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8vIFhIUiBuZWVkcyBlcnJvciBoYW5kbGluZyBmb3Igd2hlbiBzZXJ2ZXIgaXMgZG93biAoZG9lc24ndCByZXNwb25kIG9yIHNlbmRzIGJhY2sgY29kZXMpXHJcbiAgICB4aHIub25lcnJvciA9ICgpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coXCJFcnJvciB3aGlsZSB0cnlpbmcgWEhSLCB0cnlpbmcgaWRiLi4uXCIpO1xyXG4gICAgICAvLyB0cnkgaWRiLCBhbmQgaWYgd2UgZ2V0IHJlc3RhdXJhbnRzIGJhY2ssIHJldHVybiB0aGVtLCBvdGhlcndpc2UgcmV0dXJuIGFuIGVycm9yXHJcbiAgICAgIGRiUHJvbWlzZS5nZXRSZXN0YXVyYW50cygpLnRoZW4oaWRiUmVzdGF1cmFudHMgPT4ge1xyXG4gICAgICAgIGlmIChpZGJSZXN0YXVyYW50cy5sZW5ndGgpIHtcclxuICAgICAgICAgIGNhbGxiYWNrKG51bGwsIGlkYlJlc3RhdXJhbnRzKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY2FsbGJhY2soXCJObyByZXN0YXVyYW50cyBmb3VuZCBpbiBpZGJcIiwgbnVsbCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH07XHJcbiAgICB4aHIuc2VuZCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYSByZXN0YXVyYW50IGJ5IGl0cyBJRC5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgY2FsbGJhY2spIHtcclxuICAgIHRoaXMuc3luY09mZmxpbmVSZXZpZXdzKCk7XHJcbiAgICBmZXRjaChgJHtEQkhlbHBlci5BUElfVVJMfS9yZXN0YXVyYW50cy8ke2lkfWApXHJcbiAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcclxuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKVxyXG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFwiUmVzdGF1cmFudCBjb3VsZG4ndCBiZSBmZXRjaGVkIGZyb20gbmV0d29ya1wiKTtcclxuICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbihmZXRjaGVkUmVzdGF1cmFudCA9PiB7XHJcbiAgICAgICAgLy8gaWYgcmVzdGF1cmFudCBjb3VsZCBiZSBmZXRjaGVkIGZyb20gbmV0d29yazpcclxuICAgICAgICBkYlByb21pc2UucHV0UmVzdGF1cmFudHMoZmV0Y2hlZFJlc3RhdXJhbnQpO1xyXG4gICAgICAgIHJldHVybiBjYWxsYmFjayhudWxsLCBmZXRjaGVkUmVzdGF1cmFudCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChuZXR3b3JrRXJyb3IgPT4ge1xyXG4gICAgICAgIC8vIGlmIHJlc3RhdXJhbnQgY291bGRuJ3QgYmUgZmV0Y2hlZCBmcm9tIG5ldHdvcms6XHJcbiAgICAgICAgY29uc29sZS5sb2coYCR7bmV0d29ya0Vycm9yfSwgdHJ5aW5nIGlkYi5gKTtcclxuICAgICAgICBkYlByb21pc2UuZ2V0UmVzdGF1cmFudHMoaWQpLnRoZW4oaWRiUmVzdGF1cmFudCA9PiB7XHJcbiAgICAgICAgICBpZiAoIWlkYlJlc3RhdXJhbnQpXHJcbiAgICAgICAgICAgIHJldHVybiBjYWxsYmFjayhcIlJlc3RhdXJhbnQgbm90IGZvdW5kIGluIGlkYiBlaXRoZXJcIiwgbnVsbCk7XHJcbiAgICAgICAgICByZXR1cm4gY2FsbGJhY2sobnVsbCwgaWRiUmVzdGF1cmFudCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggcmVzdGF1cmFudCByZXZpZXdzIGJ5IHJlc3RhdXJhbnQgaWQuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoc1Jldmlld3NCeVJlc3RhdXJhbnRJZChpZCkge1xyXG4gICAgcmV0dXJuIGRiUHJvbWlzZS5nZXRSZXZpZXdzRm9yUmVzdGF1cmFudChpZCkudGhlbihpZGJSZXZpZXdzID0+IHtcclxuICAgICAgaWYgKCFpZGJSZXZpZXdzLmxlbmd0aCkge1xyXG4gICAgICAgIGNvbnNvbGUuaW5mbyhcIk5vIHJldmlld3MgaW4gaWRiXCIsIGlkYlJldmlld3MpO1xyXG4gICAgICAgIGNvbnNvbGUuaW5mbyhcIkZldGNoaW5nIGZyb20gQVBJXCIpO1xyXG5cclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7REJIZWxwZXIuQVBJX1VSTH0vcmV2aWV3cy8/cmVzdGF1cmFudF9pZD0ke2lkfWApXHJcbiAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiByZXNwb25zZS5qc29uKCkpXHJcbiAgICAgICAgICAudGhlbihmZXRjaGVkUmV2aWV3cyA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIkZvdW5kIFJldmlld3Mgc2F2aW5nIHRvIGlkYlwiKTtcclxuICAgICAgICAgICAgZGJQcm9taXNlLnB1dFJldmlld3MoZmV0Y2hlZFJldmlld3MpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGZldGNoZWRSZXZpZXdzO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaChlcnIgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiUmV2aWV3cyBjb3VsZG4ndCBiZSBmZXRjaGVkIGZyb20gbmV0d29yaywgc29ycnkuXCIpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5pbmZvKFwiRm91bmQgcmV2aWV3cyBvbiBpZGJcIik7XHJcblxyXG4gICAgICAgIHJldHVybiBpZGJSZXZpZXdzO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEkgaGF2ZSBhbiBpZGIgY29sbGVjdGlvbiBvZiBvZmZsaW5lIG1lc3NhZ2VzIHRoYXQgbmVlZCB0byBnZXQgb25saW5lXHJcbiAgICovXHJcbiAgc3RhdGljIHN5bmNPZmZsaW5lUmV2aWV3cygpIHtcclxuICAgIHJldHVybiBkYlByb21pc2UuZ2V0T2ZmbGluZVJldmlld3MoKS50aGVuKHJldmlld3MgPT4ge1xyXG4gICAgICAvLyBJZiB3ZSBhY3R1YWxseSBnb3Qgc29tZSByZXZpZXdzLCBzZW5kIHRoZW0gdG8gaWRiLCBub3Qgc3VyZSBpZiBJIHNlbmQgd2hvbGUgb2JqZWN0XHJcbiAgICAgIGlmIChyZXZpZXdzKSB7XHJcbiAgICAgICAgY29uc3QgdXJsID0gYCR7REJIZWxwZXIuQVBJX1VSTH0vcmV2aWV3cy9gO1xyXG4gICAgICAgIGNvbnN0IFBPU1QgPSB7XHJcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmV2aWV3cylcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICByZXR1cm4gZmV0Y2godXJsLCBQT1NUKS50aGVuKHJlc3BvbnNlID0+IHtcclxuICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFwiV2UgY291bGRuJ3QgcG9zdCByZXZpZXcgdG8gc2VydmVyLlwiKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIlBvc3RlZCBvZmZsaW5lIHJldmlld3MgdG8gYXBpIHN1Y2Nlc3NmdWxseVwiKTtcclxuICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICogSSBoYXZlIGFuIGlkYiBjb2xsZWN0aW9uIG9mIG9mZmxpbmUgbWVzc2FnZXMgdGhhdCBuZWVkIHRvIGdldCBvbmxpbmVcclxuICAgKi9cclxuICBzdGF0aWMgc3luY09mZmxpbmVmYXYoKSB7XHJcbiAgICByZXR1cm4gZGJQcm9taXNlLmdldE9mZmxpbmVmYXZzKCkudGhlbihmYXZzID0+IHtcclxuICAgICAgLy8gSWYgd2UgYWN0dWFsbHkgZ290IHNvbWUgZmF2cywgc2VuZCB0aGVtIHRvIGlkYlxyXG4gICAgICBpZiAoZmF2cykge1xyXG4gICAgICAgIGNvbnN0IHVybCA9IGAke0RCSGVscGVyLkFQSV9VUkx9L3Jlc3RhdXJhbnRzLyR7cmVzdGF1cmFudElkfS8/aXNfZmF2b3JpdGU9JHshZmF2fWA7XHJcbiAgICAgICAgY29uc3QgUFVUID0ge1xyXG4gICAgICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHJldHVybiBmZXRjaCh1cmwsIFBVVCkudGhlbihyZXNwb25zZSA9PiB7XHJcbiAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChcIldlIGNvdWxkbid0IHBvc3QgZmF2IHRvIHNlcnZlci5cIik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBjb25zb2xlLmluZm8oXCJQb3N0ZWQgb2ZmbGluZSBmYXZzIHRvIGFwaSBzdWNjZXNzZnVsbHlcIik7XHJcbiAgICAgICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgdHlwZSB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lKGN1aXNpbmUsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHMgIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEZpbHRlciByZXN0YXVyYW50cyB0byBoYXZlIG9ubHkgZ2l2ZW4gY3Vpc2luZSB0eXBlXHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpO1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeU5laWdoYm9yaG9vZChuZWlnaGJvcmhvb2QsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBuZWlnaGJvcmhvb2RcclxuICAgICAgICBjb25zdCByZXN1bHRzID0gcmVzdGF1cmFudHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgYW5kIGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoXHJcbiAgICBjdWlzaW5lLFxyXG4gICAgbmVpZ2hib3Job29kLFxyXG4gICAgY2FsbGJhY2tcclxuICApIHtcclxuICAgIC8vIEZldGNoIGFsbCByZXN0YXVyYW50c1xyXG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50cygoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICAgIGlmIChlcnJvcikge1xyXG4gICAgICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBsZXQgcmVzdWx0cyA9IHJlc3RhdXJhbnRzO1xyXG4gICAgICAgIGlmIChjdWlzaW5lICE9IFwiYWxsXCIpIHtcclxuICAgICAgICAgIC8vIGZpbHRlciBieSBjdWlzaW5lXHJcbiAgICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5maWx0ZXIociA9PiByLmN1aXNpbmVfdHlwZSA9PSBjdWlzaW5lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG5laWdoYm9yaG9vZCAhPSBcImFsbFwiKSB7XHJcbiAgICAgICAgICAvLyBmaWx0ZXIgYnkgbmVpZ2hib3Job29kXHJcbiAgICAgICAgICByZXN1bHRzID0gcmVzdWx0cy5maWx0ZXIociA9PiByLm5laWdoYm9yaG9vZCA9PSBuZWlnaGJvcmhvb2QpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCBhbGwgbmVpZ2hib3Job29kcyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hOZWlnaGJvcmhvb2RzKGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gR2V0IGFsbCBuZWlnaGJvcmhvb2RzIGZyb20gYWxsIHJlc3RhdXJhbnRzXHJcbiAgICAgICAgY29uc3QgbmVpZ2hib3Job29kcyA9IHJlc3RhdXJhbnRzLm1hcChcclxuICAgICAgICAgICh2LCBpKSA9PiByZXN0YXVyYW50c1tpXS5uZWlnaGJvcmhvb2RcclxuICAgICAgICApO1xyXG4gICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gbmVpZ2hib3Job29kc1xyXG4gICAgICAgIGNvbnN0IHVuaXF1ZU5laWdoYm9yaG9vZHMgPSBuZWlnaGJvcmhvb2RzLmZpbHRlcihcclxuICAgICAgICAgICh2LCBpKSA9PiBuZWlnaGJvcmhvb2RzLmluZGV4T2YodikgPT0gaVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgdW5pcXVlTmVpZ2hib3Job29kcyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIGN1aXNpbmVzIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaEN1aXNpbmVzKGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gR2V0IGFsbCBjdWlzaW5lcyBmcm9tIGFsbCByZXN0YXVyYW50c1xyXG4gICAgICAgIGNvbnN0IGN1aXNpbmVzID0gcmVzdGF1cmFudHMubWFwKCh2LCBpKSA9PiByZXN0YXVyYW50c1tpXS5jdWlzaW5lX3R5cGUpO1xyXG4gICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gY3Vpc2luZXNcclxuICAgICAgICBjb25zdCB1bmlxdWVDdWlzaW5lcyA9IGN1aXNpbmVzLmZpbHRlcihcclxuICAgICAgICAgICh2LCBpKSA9PiBjdWlzaW5lcy5pbmRleE9mKHYpID09IGlcclxuICAgICAgICApO1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHVuaXF1ZUN1aXNpbmVzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXN0YXVyYW50IHBhZ2UgVVJMLlxyXG4gICAqL1xyXG4gIHN0YXRpYyB1cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcclxuICAgIHJldHVybiBgLi9yZXN0YXVyYW50Lmh0bWw/aWQ9JHtyZXN0YXVyYW50LmlkfWA7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXN0YXVyYW50IGltYWdlIFVSTC5cclxuICAgKi9cclxuICBzdGF0aWMgaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcclxuICAgIGNvbnN0IHVybCA9IGAuL2ltZy8ke3Jlc3RhdXJhbnQucGhvdG9ncmFwaCB8fCByZXN0YXVyYW50LmlkfS1tZWRpdW0uanBnYDtcclxuXHJcbiAgICByZXR1cm4gdXJsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVzdGF1cmFudCBzcmNzZXQgYXR0cmlidXRlIGZvciBicm93c2VyIHRvIGRlY2lkZSBiZXN0IHJlc29sdXRpb24uIEl0IHVzZXMgcmVzdGF1cmFudC5waG90b2dyYXBoXHJcbiAgICogYW5kIGZhbGxiYWNrcyB0byByZXN0YXVyYW50LmlkIGlmIGZvcm1lciBpcyBtaXNzaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBpbWFnZVNyY3NldEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCkge1xyXG4gICAgY29uc3QgaW1hZ2VTcmMgPSBgLi9pbWcvJHtyZXN0YXVyYW50LnBob3RvZ3JhcGggfHwgcmVzdGF1cmFudC5pZH1gO1xyXG4gICAgcmV0dXJuIGAke2ltYWdlU3JjfS1zbWFsbC5qcGcgMzAwdyxcclxuICAgICAgICAgICAgJHtpbWFnZVNyY30tbWVkaXVtLmpwZyA2MDB3LFxyXG4gICAgICAgICAgICAke2ltYWdlU3JjfS1sYXJnZS5qcGcgODAwd2A7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXN0YXVyYW50IHNpemVzIGF0dHJpYnV0ZSBzbyBicm93c2VyIGtub3dzIGltYWdlIHNpemVzIGJlZm9yZSBkZWNpZGluZ1xyXG4gICAqIHdoYXQgaW1hZ2UgdG8gZG93bmxvYWQuXHJcbiAgICovXHJcbiAgc3RhdGljIGltYWdlU2l6ZXNGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcclxuICAgIHJldHVybiBgKG1heC13aWR0aDogMzYwcHgpIDI4MHB4LFxyXG4gICAgICAgICAgICAobWF4LXdpZHRoOiA2MDBweCkgNjAwcHgsXHJcbiAgICAgICAgICAgIDQwMHB4YDtcclxuICB9XHJcblxyXG4gIHN0YXRpYyBtYXBNYXJrZXJGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIG1hcCkge1xyXG4gICAgY29uc3QgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XHJcbiAgICAgIHBvc2l0aW9uOiByZXN0YXVyYW50LmxhdGxuZyxcclxuICAgICAgdGl0bGU6IHJlc3RhdXJhbnQubmFtZSxcclxuICAgICAgdXJsOiBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpLFxyXG4gICAgICBtYXA6IG1hcCxcclxuICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUFxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gbWFya2VyO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgaWRiIGZyb20gXCJpZGJcIjtcclxuXHJcbmNvbnN0IGRiUHJvbWlzZSA9IHtcclxuICAvLyBjcmVhdGlvbiBhbmQgdXBkYXRpbmcgb2YgZGF0YWJhc2UgaGFwcGVucyBoZXJlLlxyXG4gIGRiOiBpZGIub3BlbihcInJlc3RhdXJhbnQtcmV2aWV3cy1kYlwiLCAzLCBmdW5jdGlvbiAodXBncmFkZURiKSB7XHJcbiAgICBzd2l0Y2ggKHVwZ3JhZGVEYi5vbGRWZXJzaW9uKSB7XHJcbiAgICAgIGNhc2UgMDpcclxuICAgICAgICB1cGdyYWRlRGIuY3JlYXRlT2JqZWN0U3RvcmUoXCJyZXN0YXVyYW50c1wiLCB7IGtleVBhdGg6IFwiaWRcIiB9KTtcclxuICAgICAgY2FzZSAxOlxyXG4gICAgICAgIHVwZ3JhZGVEYlxyXG4gICAgICAgICAgLmNyZWF0ZU9iamVjdFN0b3JlKFwicmV2aWV3c1wiLCB7IGtleVBhdGg6IFwiaWRcIiB9KVxyXG4gICAgICAgICAgLmNyZWF0ZUluZGV4KFwicmVzdGF1cmFudF9pZFwiLCBcInJlc3RhdXJhbnRfaWRcIik7XHJcbiAgICAgIGNhc2UgMjpcclxuICAgICAgICB1cGdyYWRlRGJcclxuICAgICAgICAgIC5jcmVhdGVPYmplY3RTdG9yZShcIm9mZmxpbmVcIiwgeyBhdXRvSW5jcmVtZW50OiB0cnVlLCBrZXlQYXRoOiBcImlkXCIgfSlcclxuICAgICAgICAgIC5jcmVhdGVJbmRleChcInJlc3RhdXJhbnRfaWRcIiwgXCJyZXN0YXVyYW50X2lkXCIpO1xyXG4gICAgICBjYXNlIDM6XHJcbiAgICAgICAgdXBncmFkZURiXHJcbiAgICAgICAgICAuY3JlYXRlT2JqZWN0U3RvcmUoXCJvZmZsaW5lLWZhdlwiLCB7IGF1dG9JbmNyZW1lbnQ6IHRydWUsIGtleVBhdGg6IFwiaWRcIiB9KVxyXG4gICAgICAgICAgLmNyZWF0ZUluZGV4KFwicmVzdGF1cmFudF9pZFwiLCBcInJlc3RhdXJhbnRfaWRcIik7XHJcbiAgICB9XHJcbiAgfSksXHJcblxyXG4gIC8qKlxyXG4gICAqIFNhdmUgcmVzdGF1cmFudFxyXG4gICAqL1xyXG4gIHB1dFJlc3RhdXJhbnRzKHJlc3RhdXJhbnRzLCBmb3JjZVVwZGF0ZSA9IGZhbHNlKSB7XHJcbiAgICBpZiAoIXJlc3RhdXJhbnRzLnB1c2gpIHJlc3RhdXJhbnRzID0gW3Jlc3RhdXJhbnRzXTtcclxuICAgIHJldHVybiB0aGlzLmRiLnRoZW4oZGIgPT4ge1xyXG4gICAgICBjb25zdCBzdG9yZSA9IGRiXHJcbiAgICAgICAgLnRyYW5zYWN0aW9uKFwicmVzdGF1cmFudHNcIiwgXCJyZWFkd3JpdGVcIilcclxuICAgICAgICAub2JqZWN0U3RvcmUoXCJyZXN0YXVyYW50c1wiKTtcclxuICAgICAgUHJvbWlzZS5hbGwoXHJcbiAgICAgICAgcmVzdGF1cmFudHMubWFwKGFwaVJlc3RhdXJhbnQgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIHN0b3JlLmdldChhcGlSZXN0YXVyYW50LmlkKS50aGVuKGlkYlJlc3RhdXJhbnQgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZm9yY2VVcGRhdGUpIHJldHVybiBzdG9yZS5wdXQoYXBpUmVzdGF1cmFudCk7XHJcbiAgICAgICAgICAgIGlmIChcclxuICAgICAgICAgICAgICAhaWRiUmVzdGF1cmFudCB8fFxyXG4gICAgICAgICAgICAgIG5ldyBEYXRlKGFwaVJlc3RhdXJhbnQudXBkYXRlZEF0KSA+XHJcbiAgICAgICAgICAgICAgbmV3IERhdGUoaWRiUmVzdGF1cmFudC51cGRhdGVkQXQpXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgIHJldHVybiBzdG9yZS5wdXQoYXBpUmVzdGF1cmFudCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICkudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHN0b3JlLmNvbXBsZXRlO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIHB1dEZhdm9yaXRlKGlkLCBib29sZWFuKSB7XHJcbiAgICByZXR1cm4gdGhpcy5kYlxyXG4gICAgICAudGhlbigoZGIpID0+IHtcclxuICAgICAgICBjb25zdCBzdG9yZSA9IGRiXHJcbiAgICAgICAgICAudHJhbnNhY3Rpb24oXCJyZXN0YXVyYW50c1wiLCBcInJlYWR3cml0ZVwiKVxyXG4gICAgICAgICAgLm9iamVjdFN0b3JlKFwicmVzdGF1cmFudHNcIik7XHJcblxyXG4gICAgICAgIHN0b3JlLmdldChpZClcclxuICAgICAgICAgIC50aGVuKChpZGJSZXN0YXVyYW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlkYlJlc3RhdXJhbnQuaXNfZmF2b3JpdGUgPSBib29sZWFuLnRvU3RyaW5nKCk7XHJcblxyXG4gICAgICAgICAgICBzdG9yZS5wdXQoaWRiUmVzdGF1cmFudCk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gc3RvcmUuY29tcGxldGU7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICB9KS50aGVuKCgpID0+IHtcclxuICAgICAgICBjb25zb2xlLmluZm8oJ1VwZGF0ZWQgZmF2IGluIGlkYicpO1xyXG4gICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgZmF2IGluIGlkYicsIGVycik7XHJcbiAgICAgIH0pXHJcbiAgfSxcclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHJlc3RhdXJhbnRcclxuICAgKi9cclxuICBnZXRSZXN0YXVyYW50cyhpZCA9IHVuZGVmaW5lZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZGIudGhlbihkYiA9PiB7XHJcbiAgICAgIGNvbnN0IHN0b3JlID0gZGIudHJhbnNhY3Rpb24oXCJyZXN0YXVyYW50c1wiKS5vYmplY3RTdG9yZShcInJlc3RhdXJhbnRzXCIpO1xyXG4gICAgICBpZiAoaWQpIHJldHVybiBzdG9yZS5nZXQoTnVtYmVyKGlkKSk7XHJcbiAgICAgIHJldHVybiBzdG9yZS5nZXRBbGwoKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIC8qKlxyXG4gICAqIFNhdmUgcmV2aWV3c1xyXG4gICAqL1xyXG4gIHB1dFJldmlld3MocmV2aWV3cykge1xyXG4gICAgaWYgKCFyZXZpZXdzLnB1c2gpIHJldmlld3MgPSBbcmV2aWV3c107XHJcbiAgICByZXR1cm4gdGhpcy5kYi50aGVuKGRiID0+IHtcclxuICAgICAgY29uc3Qgc3RvcmUgPSBkYlxyXG4gICAgICAgIC50cmFuc2FjdGlvbihcInJldmlld3NcIiwgXCJyZWFkd3JpdGVcIilcclxuICAgICAgICAub2JqZWN0U3RvcmUoXCJyZXZpZXdzXCIpO1xyXG4gICAgICBQcm9taXNlLmFsbChcclxuICAgICAgICByZXZpZXdzLm1hcChhcGlSZXZpZXcgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIHN0b3JlLmdldChhcGlSZXZpZXcuaWQpLnRoZW4oaWRiUmV2aWV3ID0+IHtcclxuICAgICAgICAgICAgaWYgKFxyXG4gICAgICAgICAgICAgICFpZGJSZXZpZXcgfHxcclxuICAgICAgICAgICAgICBuZXcgRGF0ZShhcGlSZXZpZXcudXBkYXRlZEF0KSA+IG5ldyBEYXRlKGlkYlJldmlldy51cGRhdGVkQXQpXHJcbiAgICAgICAgICAgICkge1xyXG4gICAgICAgICAgICAgIHJldHVybiBzdG9yZS5wdXQoYXBpUmV2aWV3KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4gc3RvcmUuY29tcGxldGU7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgZ2V0UmV2aWV3c0ZvclJlc3RhdXJhbnQoaWQpIHtcclxuICAgIHJldHVybiB0aGlzLmRiLnRoZW4oZGIgPT4ge1xyXG4gICAgICBjb25zdCBzdG9yZUluZGV4ID0gZGJcclxuICAgICAgICAudHJhbnNhY3Rpb24oXCJyZXZpZXdzXCIpXHJcbiAgICAgICAgLm9iamVjdFN0b3JlKFwicmV2aWV3c1wiKVxyXG4gICAgICAgIC5pbmRleChcInJlc3RhdXJhbnRfaWRcIik7XHJcbiAgICAgIHJldHVybiBzdG9yZUluZGV4LmdldEFsbChOdW1iZXIoaWQpKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIC8vIFN0b3Jpbmcgb2ZmbGluZSByZXZpZXdzIHRvIG9mZmxpbmUgaWRiIGNvbGxlY3Rpb25cclxuICBwdXRPZmZsaW5lUmV2aWV3KHJldmlldykge1xyXG4gICAgcmV0dXJuIHRoaXMuZGJcclxuICAgICAgLnRoZW4oZGIgPT4ge1xyXG4gICAgICAgIGNvbnN0IHN0b3JlID0gZGIudHJhbnNhY3Rpb24oXCJvZmZsaW5lXCIsIFwicmVhZHdyaXRlXCIpLm9iamVjdFN0b3JlKFwib2ZmbGluZVwiKTtcclxuICAgICAgICBzdG9yZS5wdXQocmV2aWV3KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHN0b3JlLmNvbXBsZXRlO1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5pbmZvKCdTYXZlZCBhIHJldmlldyB0byBpZGIgd2hpbGUgb2ZmbGluZScpO1xyXG4gICAgICAgIC8vIG5hdmlnYXRvci5zZXJ2aWNlV29ya2VyLnJlYWR5LnRoZW4ocmVnaXN0cmF0aW9uID0+IHtcclxuICAgICAgICAvLyAgIHJldHVybiByZWdpc3RyYXRpb24uc3luYy5yZWdpc3RlcihcImZsdXNoXCIpO1xyXG4gICAgICAgIC8vIH0pO1xyXG4gICAgICB9KTtcclxuICB9LFxyXG5cclxuICAvLyBHZXR0aW5nIHdoYXRldmVyIEkgaGF2ZSBpbiB0aGUgb2ZmbGluZSBpZGIgY29sbGVjdGlvblxyXG4gIGdldE9mZmxpbmVSZXZpZXdzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZGJcclxuICAgICAgLnRoZW4oZGIgPT4ge1xyXG4gICAgICAgIGNvbnN0IHN0b3JlID0gZGIudHJhbnNhY3Rpb24oXCJvZmZsaW5lXCIsIFwicmVhZG9ubHlcIikub2JqZWN0U3RvcmUoXCJvZmZsaW5lXCIpO1xyXG5cclxuICAgICAgICByZXR1cm4gc3RvcmUuZ2V0QWxsKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjb25zb2xlLmluZm8oJ1JldHJpZXZlZCBvZmZsaW5lIHJldmlld3MnKTtcclxuICAgICAgfSk7XHJcbiAgfSxcclxuXHJcbiAgLy8gQ2xlYXJpbmcgd2hhdGV2ZXIgSSBoYXZlIGluIHRoZSBvZmZsaW5lIGlkYiBjb2xsZWN0aW9uXHJcbiAgY2xlYXJPZmZsaW5lUmV2aWV3cygpIHtcclxuICAgIHJldHVybiB0aGlzLmRiXHJcbiAgICAgIC50aGVuKGRiID0+IHtcclxuICAgICAgICBjb25zdCBzdG9yZSA9IGRiLnRyYW5zYWN0aW9uKFwib2ZmbGluZVwiLCBcInJlYWR3cml0ZVwiKS5vYmplY3RTdG9yZShcIm9mZmxpbmVcIik7XHJcbiAgICAgICAgc3RvcmUuY2xlYXIoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHN0b3JlO1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS53YXJuaW5nKCdEZWxldGVkIG9mZmxpbmUgcmV2aWV3cycsIHJlcyk7XHJcbiAgICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIC8vIFN0b3Jpbmcgb2ZmbGluZSBmYXZzIHRvIG9mZmxpbmUgaWRiIGNvbGxlY3Rpb25cclxuICBwdXRPZmZsaW5lZmF2KGZhdikge1xyXG4gICAgcmV0dXJuIHRoaXMuZGJcclxuICAgICAgLnRoZW4oZGIgPT4ge1xyXG4gICAgICAgIGNvbnN0IHN0b3JlID0gZGIudHJhbnNhY3Rpb24oXCJvZmZsaW5lLWZhdlwiLCBcInJlYWR3cml0ZVwiKS5vYmplY3RTdG9yZShcIm9mZmxpbmUtZmF2XCIpO1xyXG4gICAgICAgIHN0b3JlLnB1dChmYXYpO1xyXG5cclxuICAgICAgICByZXR1cm4gc3RvcmUuY29tcGxldGU7XHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjb25zb2xlLmluZm8oJ1NhdmVkIGEgZmF2IHRvIGlkYiB3aGlsZSBvZmZsaW5lJyk7XHJcbiAgICAgICAgLy8gbmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVhZHkudGhlbihyZWdpc3RyYXRpb24gPT4ge1xyXG4gICAgICAgIC8vICAgcmV0dXJuIHJlZ2lzdHJhdGlvbi5zeW5jLnJlZ2lzdGVyKFwiZmx1c2hcIik7XHJcbiAgICAgICAgLy8gfSk7XHJcbiAgICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIC8vIEdldHRpbmcgd2hhdGV2ZXIgSSBoYXZlIGluIHRoZSBvZmZsaW5lIGlkYiBjb2xsZWN0aW9uXHJcbiAgZ2V0T2ZmbGluZWZhdnMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5kYlxyXG4gICAgICAudGhlbihkYiA9PiB7XHJcbiAgICAgICAgY29uc3Qgc3RvcmUgPSBkYi50cmFuc2FjdGlvbihcIm9mZmxpbmUtZmF2XCIsIFwicmVhZG9ubHlcIikub2JqZWN0U3RvcmUoXCJvZmZsaW5lLWZhdlwiKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHN0b3JlLmdldEFsbCgpO1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5pbmZvKCdSZXRyaWV2ZWQgb2ZmbGluZSBmYXZzJyk7XHJcbiAgICAgIH0pO1xyXG4gIH0sXHJcblxyXG4gIC8vIENsZWFyaW5nIHdoYXRldmVyIEkgaGF2ZSBpbiB0aGUgb2ZmbGluZSBpZGIgY29sbGVjdGlvblxyXG4gIGNsZWFyT2ZmbGluZWZhdnMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5kYlxyXG4gICAgICAudGhlbihkYiA9PiB7XHJcbiAgICAgICAgY29uc3Qgc3RvcmUgPSBkYi50cmFuc2FjdGlvbihcIm9mZmxpbmUtZmF2XCIsIFwicmVhZHdyaXRlXCIpLm9iamVjdFN0b3JlKFwib2ZmbGluZS1mYXZcIik7XHJcbiAgICAgICAgc3RvcmUuY2xlYXIoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHN0b3JlO1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS53YXJuaW5nKCdEZWxldGVkIG9mZmxpbmUgZmF2cycsIHJlcyk7XHJcbiAgICAgIH0pO1xyXG4gIH0sXHJcblxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgZGJQcm9taXNlO1xyXG4iLCJjb25zdCB7IHNlcnZpY2VXb3JrZXIgfSA9IG5hdmlnYXRvcjtcclxuXHJcbmNvbnN0IHJlZ2lzdGVyU2VydmljZVdvcmtlciA9ICgpID0+IHtcclxuICBpZiAoXCJzZXJ2aWNlV29ya2VyXCIgaW4gbmF2aWdhdG9yKSB7XHJcbiAgICBzZXJ2aWNlV29ya2VyXHJcbiAgICAgIC5yZWdpc3RlcihcIi4vc3cuanNcIiwgeyBzY29wZTogXCIuL1wiIH0pXHJcbiAgICAgIC50aGVuKHJlZ2lzdHJhdGlvbiA9PiB7XHJcbiAgICAgICAgY29uc29sZS5pbmZvKFwiU2VydmljZSB3b3JrZXIgcmVnaXN0ZXJlZFwiLCByZWdpc3RyYXRpb24uc2NvcGUpO1xyXG4gICAgICAgIGNvbnN0IHN3ID0ge307XHJcblxyXG4gICAgICAgIGlmIChyZWdpc3RyYXRpb24uaW5zdGFsbGluZykge1xyXG4gICAgICAgICAgc3cuc3RhdHVzID0gcmVnaXN0cmF0aW9uLmluc3RhbGxpbmc7XHJcbiAgICAgICAgICBjb25zb2xlLmluZm8oXCJTZXJ2aWNlIHdvcmtlciBpbnN0YWxsaW5nXCIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHJlZ2lzdHJhdGlvbi53YWl0aW5nKSB7XHJcbiAgICAgICAgICBzdy5zdGF0dXMgPSByZWdpc3RyYXRpb24ud2FpdGluZztcclxuICAgICAgICAgIGNvbnNvbGUud2FybihcIlNlcnZpY2Ugd29ya2VyIHdhaXRpbmdcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAocmVnaXN0cmF0aW9uLmFjdGl2ZSkge1xyXG4gICAgICAgICAgc3cuc3RhdHVzID0gcmVnaXN0cmF0aW9uLmFjdGl2ZTtcclxuICAgICAgICAgIGNvbnNvbGUuaW5mbyhcIlNlcnZpY2Ugd29ya2VyIGFjdGl2ZVwiKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICgnc3luYycgaW4gIHJlZ2lzdHJhdGlvbikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmluZm8oXCJTeW5jIGFjdGl2ZVwiKTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHN3LnN0YXR1cykge1xyXG4gICAgICAgICAgY29uc29sZS5sb2coXCJTZXJ2aWNlIHdvcmtlciBzdGF0ZTpcIiwgc3cuc3RhdHVzLnN0YXRlKTtcclxuICAgICAgICAgIHN3LnN0YXR1cy5hZGRFdmVudExpc3RlbmVyKFwic3RhdGVjaGFuZ2VcIiwgZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2VydmljZSB3b3JrZXIgc3RhdGU6XCIsIGUudGFyZ2V0LnN0YXRlKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGVyciA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIlNlcnZpY2Ugd29ya2VyIGluc3RhbGxhdGlvbiBmYWlsZWRcIiwgZXJyKTtcclxuICAgICAgICAvLyBsb2FkUGFnZSgpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIElmIHlvdSBlbmQgdXAgaGVyZSBzZXJ2aWNld29ya2VyIGlzIG5vdCBzdXBwb3J0ZWRcclxuICAvL2xvYWRQYWdlKCk7XHJcbn07XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLCBldmVudCA9PiB7XHJcbiAgcmVnaXN0ZXJTZXJ2aWNlV29ya2VyKCk7XHJcbn0pO1xyXG4iLCIndXNlLXN0cmljdCc7XHJcblxyXG5pbXBvcnQgREJIZWxwZXIgZnJvbSAnLi9kYmhlbHBlcic7XHJcbmltcG9ydCAnLi9yZWdpc3Rlcic7XHJcbmltcG9ydCAnLi9icm93c2VyJztcclxuaW1wb3J0IHJldmlld0Zvcm0gZnJvbSAnLi9yZXZpZXdmb3JtJztcclxuXHJcblxyXG5sZXQgcmVzdGF1cmFudCA9ICcnO1xyXG52YXIgbmV3TWFwO1xyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgbWFwIGlmIHlvdSBsb29rIGF0IHRoZSBzY3JpcHQgaW1wb3J0ZWQgZ29vZ2xlIHJ1bnMgaW5pdFxyXG4gKi9cclxud2luZG93LmluaXRNYXAgPSAoKSA9PiB7XHJcbiAgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbmV3TWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGV0YWlsLW1hcCcpLCB7XHJcbiAgICAgICAgem9vbTogMTYsXHJcbiAgICAgICAgY2VudGVyOiByZXN0YXVyYW50LmxhdGxuZyxcclxuICAgICAgICBzY3JvbGx3aGVlbDogZmFsc2VcclxuICAgICAgfSk7XHJcbiAgICAgIGZpbGxCcmVhZGNydW1iKCk7XHJcbiAgICAgIERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQoc2VsZi5yZXN0YXVyYW50LCBuZXdNYXApO1xyXG4gICAgfVxyXG4gIC8vIEdvb2dsZSBtYXAgbWFrZXMgYSBidW5jaCBvZiBsaW5rcyB0aGF0IHN0ZWFsIGZvY3VzIG9mIGEgc2NyZWVuIHJlYWRlclxyXG4gIC8vIEdvaW5nIHRvIGFkZCBhbiBldmVudCB0aGF0IHNldHMgYXR0cmlidXRlIHRvIGFsbCBvZiB0aGVzZSBpdGVtc1xyXG4gIGNvbnN0IG1hcEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RldGFpbC1tYXAnKTtcclxuICBtYXBFbC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCAoKSA9PiB7XHJcbiAgY29uc3QgbWFwTGlua3MgPSBtYXBFbC5xdWVyeVNlbGVjdG9yQWxsKCdhJyk7XHJcbiAgbWFwTGlua3MuZm9yRWFjaChsaW5rID0+IGxpbmsuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICctMScpKTtcclxufSk7XHJcbiAgXHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgY3VycmVudCByZXN0YXVyYW50IGZyb20gcGFnZSBVUkwuXHJcbiAqL1xyXG5jb25zdCBmZXRjaFJlc3RhdXJhbnRGcm9tVVJMID0gKGNhbGxiYWNrKSA9PiB7XHJcbiAgaWYgKHNlbGYucmVzdGF1cmFudCkgeyAvLyByZXN0YXVyYW50IGFscmVhZHkgZmV0Y2hlZCFcclxuICAgIGNhbGxiYWNrKG51bGwsIHNlbGYucmVzdGF1cmFudClcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgY29uc3QgaWQgPSBnZXRQYXJhbWV0ZXJCeU5hbWUoJ2lkJyk7XHJcbiAgaWYgKCFpZCkgeyAvLyBubyBpZCBmb3VuZCBpbiBVUkxcclxuICAgIGVycm9yID0gJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJ1xyXG4gICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUlkKGlkLCAoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcclxuICAgICAgc2VsZi5yZXN0YXVyYW50ID0gcmVzdGF1cmFudDtcclxuICAgICAgaWYgKCFyZXN0YXVyYW50KSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpO1xyXG4gICAgICBjYWxsYmFjayhudWxsLCByZXN0YXVyYW50KVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogQ3JlYXRlIHJlc3RhdXJhbnQgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlXHJcbiAqL1xyXG5jb25zdCBmaWxsUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1uYW1lJyk7XHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcblxyXG4gIC8vIGNvbnN0IGZhdkJ1dHRvbkNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmYXYtYnV0dG9uLWNvbnRhaW5lcicpO1xyXG4gIC8vIGZhdkJ1dHRvbkNvbnRhaW5lci5hcHBlbmRDaGlsZChmYXZvcml0ZUJ1dHRvbihyZXN0YXVyYW50KSk7XHJcbiAgLy8gZmF2QnV0dG9uQ29udGFpbmVyLmFsdCA9IGBTYXZlICR7cmVzdGF1cmFudC5uYW1lfSBhcyBhIGZhdm9yaXRlYDtcclxuXHJcbiAgY29uc3QgYWRkcmVzcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWFkZHJlc3MnKTtcclxuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcclxuXHJcbiAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1pbWcnKTtcclxuICBpbWFnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcnO1xyXG4gIGltYWdlLmNsYXNzTGlzdC5hZGQgPSAnbGF6eWxvYWQnO1xyXG4gIGltYWdlLnNyYyA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuICBpbWFnZS5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVNyY3NldEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgaW1hZ2Uuc2l6ZXMgPSBEQkhlbHBlci5pbWFnZVNpemVzRm9yUmVzdGF1cmFudChyZXN0YXVyYW50KTtcclxuICBpbWFnZS5hbHQgPSBgJHtyZXN0YXVyYW50Lm5hbWV9IHByb21vdGlvbmFsIGltYWdlYDtcclxuXHJcbiAgY29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKTtcclxuICBjdWlzaW5lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuY3Vpc2luZV90eXBlO1xyXG5cclxuICAvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xyXG4gIGlmIChyZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vycykge1xyXG4gICAgZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwoKTtcclxuICB9XHJcbiAgLy8gZmlsbCByZXZpZXdzXHJcbiAgREJIZWxwZXIuZmV0Y2hzUmV2aWV3c0J5UmVzdGF1cmFudElkKHJlc3RhdXJhbnQuaWQpXHJcbiAgLnRoZW4oKHJldmlld3MpID0+IGZpbGxSZXZpZXdzSFRNTChyZXZpZXdzKSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBvcGVyYXRpbmcgaG91cnMgSFRNTCB0YWJsZSBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxyXG4gKi9cclxuY29uc3QgZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwgPSAob3BlcmF0aW5nSG91cnMgPSBzZWxmLnJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSA9PiB7XHJcbiAgY29uc3QgaG91cnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1ob3VycycpO1xyXG4gIGZvciAobGV0IGtleSBpbiBvcGVyYXRpbmdIb3Vycykge1xyXG4gICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTtcclxuXHJcbiAgICBjb25zdCBkYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xyXG4gICAgZGF5LmlubmVySFRNTCA9IGtleTtcclxuICAgIHJvdy5hcHBlbmRDaGlsZChkYXkpO1xyXG5cclxuICAgIGNvbnN0IHRpbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xyXG4gICAgdGltZS5pbm5lckhUTUwgPSBvcGVyYXRpbmdIb3Vyc1trZXldO1xyXG4gICAgcm93LmFwcGVuZENoaWxkKHRpbWUpO1xyXG4gICAgaG91cnMuc2V0QXR0cmlidXRlKCd0YWJpbmRleCcsICcwJyk7XHJcbiAgICBob3Vycy5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBgSG91cnMgb2Ygb3BlcmF0aW9uIGZvciAke3NlbGYucmVzdGF1cmFudC5uYW1lfWApXHJcbiAgICBob3Vycy5hcHBlbmRDaGlsZChyb3cpO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBhbGwgcmV2aWV3cyBIVE1MIGFuZCBhZGQgdGhlbSB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmNvbnN0IGZpbGxSZXZpZXdzSFRNTCA9IChyZXZpZXdzID0gc2VsZi5yZXN0YXVyYW50LnJldmlld3MpID0+IHtcclxuICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1jb250YWluZXInKTtcclxuICBjb25zdCB0aXRsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XHJcbiAgdGl0bGUuaW5uZXJIVE1MID0gJ1Jldmlld3MnO1xyXG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aXRsZSk7XHJcblxyXG4gIGNvbnN0IGxpc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICBsaXN0LmlkID0gJ2xpc3QtY29udGFpbmVyJztcclxuICBjb250YWluZXIuYXBwZW5kQ2hpbGQobGlzdCk7XHJcblxyXG4gIGNvbnN0IHVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTtcclxuICB1bC5pZCA9ICdyZXZpZXdzLWxpc3QnO1xyXG4gIHVsLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnMCcpO1xyXG4gIHVsLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGBMaXN0IG9mIHJlc3RhdXJhbnQgcmV2aWV3cyBmb3IgJHtzZWxmLnJlc3RhdXJhbnQubmFtZX1gKTtcclxuICBsaXN0LmFwcGVuZENoaWxkKHVsKTtcclxuXHJcbiAgaWYgKCFyZXZpZXdzKSB7XHJcbiAgICBjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgICBub1Jldmlld3MuaW5uZXJIVE1MID0gJ05vIHJldmlld3MgeWV0ISc7XHJcbiAgICBub1Jldmlld3MuaWQgPSAnbm8tcmV2aWV3cyc7XHJcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobm9SZXZpZXdzKTtcclxuXHJcbiAgfSBlbHNlIHtcclxuICAgIHJldmlld3MuZm9yRWFjaChyZXZpZXcgPT4ge1xyXG4gICAgICB1bC5hcHBlbmRDaGlsZChjcmVhdGVSZXZpZXdIVE1MKHJldmlldykpO1xyXG5cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgaGVhZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gzJyk7XHJcbiAgaGVhZC5pbm5lckhUTUwgPSBcIkxlYXZlIGEgUmV2aWV3XCI7XHJcbiAgY29udGFpbmVyLmFwcGVuZENoaWxkKGhlYWQpO1xyXG4gIGNvbnN0IGlkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdpZCcpO1xyXG4gIGNvbnRhaW5lci5hcHBlbmRDaGlsZChyZXZpZXdGb3JtKGlkKSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmV2aWV3IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cclxuICovXHJcbmNvbnN0IGNyZWF0ZVJldmlld0hUTUwgPSAocmV2aWV3KSA9PiB7XHJcbiAgY29uc3QgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgbmFtZS5pbm5lckhUTUwgPSByZXZpZXcubmFtZTtcclxuICBuYW1lLmNsYXNzTmFtZSA9ICdyZXZpZXdlcic7XHJcbiAgbmFtZS5zZXRBdHRyaWJ1dGUoJ2FsdCcsICdSZXZpZXdlciBuYW1lJyk7XHJcbiAgbGkuYXBwZW5kQ2hpbGQobmFtZSk7XHJcblxyXG4gIGNvbnN0IGRhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgZGF0ZS5pbm5lckhUTUwgPSBuZXcgRGF0ZShyZXZpZXcuY3JlYXRlZEF0KS50b0xvY2FsZURhdGVTdHJpbmcoKTtcclxuICBkYXRlLmNsYXNzTmFtZSA9ICdkYXRlJztcclxuICBkYXRlLnNldEF0dHJpYnV0ZSgnYWx0JywgJ0RhdGUgcmV2aWV3ZWQnKTtcclxuICBsaS5hcHBlbmRDaGlsZChkYXRlKTtcclxuXHJcbiAgY29uc3QgcmF0aW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIHJhdGluZy5pbm5lckhUTUwgPSBgUmF0aW5nOiAke3Jldmlldy5yYXRpbmd9YDtcclxuICByYXRpbmcuY2xhc3NOYW1lID0gJ3JhdGluZyc7XHJcbiAgcmF0aW5nLnNldEF0dHJpYnV0ZSgnYWx0JywgJ1JhdGluZyBnaXZlbiBieSByZXZpZXdlcicpO1xyXG4gIGxpLmFwcGVuZENoaWxkKHJhdGluZyk7XHJcblxyXG4gIGNvbnN0IGNvbW1lbnRzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIGNvbW1lbnRzLmlubmVySFRNTCA9IHJldmlldy5jb21tZW50cztcclxuICBjb21tZW50cy5jbGFzc05hbWUgPSAnY29tbWVudHMnO1xyXG4gIGNvbW1lbnRzLnNldEF0dHJpYnV0ZSgnYWx0JywgJ0NvbW1lbnRzIHdyaXR0ZW4gYnkgcmV2aWV3ZXInKTtcclxuICBsaS5hcHBlbmRDaGlsZChjb21tZW50cyk7XHJcblxyXG4gIHJldHVybiBsaTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEFkZCByZXN0YXVyYW50IG5hbWUgdG8gdGhlIGJyZWFkY3J1bWIgbmF2aWdhdGlvbiBtZW51XHJcbiAqL1xyXG5jb25zdCBmaWxsQnJlYWRjcnVtYiA9IChyZXN0YXVyYW50PXNlbGYucmVzdGF1cmFudCkgPT4ge1xyXG4gIGNvbnN0IGJyZWFkY3J1bWIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnJlYWRjcnVtYicpO1xyXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcclxuICBsaS5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5hbWU7XHJcbiAgYnJlYWRjcnVtYi5hcHBlbmRDaGlsZChsaSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZXQgYSBwYXJhbWV0ZXIgYnkgbmFtZSBmcm9tIHBhZ2UgVVJMLlxyXG4gKi9cclxuY29uc3QgZ2V0UGFyYW1ldGVyQnlOYW1lID0gKG5hbWUsIHVybCkgPT4ge1xyXG4gIGlmICghdXJsKVxyXG4gICAgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XHJcbiAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW1xcXV0vZywgJ1xcXFwkJicpO1xyXG4gIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgWz8mXSR7bmFtZX0oPShbXiYjXSopfCZ8I3wkKWApLFxyXG4gICAgcmVzdWx0cyA9IHJlZ2V4LmV4ZWModXJsKTtcclxuICBpZiAoIXJlc3VsdHMpXHJcbiAgICByZXR1cm4gbnVsbDtcclxuICBpZiAoIXJlc3VsdHNbMl0pXHJcbiAgICByZXR1cm4gJyc7XHJcbiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcclxufVxyXG4iLCJpbXBvcnQgREJIZWxwZXIgZnJvbSBcIi4vZGJoZWxwZXJcIjtcclxuaW1wb3J0IGRiUHJvbWlzZSBmcm9tIFwiLi9kYnByb21pc2VcIjtcclxuXHJcbi8qKlxyXG4gKiBSZXR1cm5zIGEgbGkgZWxlbWVudCB3aXRoIHJldmlldyBkYXRhIHNvIGl0IGNhbiBiZSBhcHBlbmRlZCB0b1xyXG4gKiB0aGUgcmV2aWV3IGxpc3QuXHJcbiAqL1xyXG5mdW5jdGlvbiBjcmVhdGVSZXZpZXdIVE1MKHJldmlldykge1xyXG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpXCIpO1xyXG4gIGNvbnN0IHJldmlld2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XHJcbiAgcmV2aWV3ZXIuaW5uZXJIVE1MID0gcmV2aWV3ZXIubmFtZTtcclxuICByZXZpZXdlci5jbGFzc05hbWUgPSAncmV2aWV3ZXInO1xyXG4gIHJldmlld2VyLnNldEF0dHJpYnV0ZSgnYWx0JywgJ1Jldmlld2VyIG5hbWUnKTtcclxuICBsaS5hcHBlbmRDaGlsZChyZXZpZXdlcik7XHJcblxyXG4gIGNvbnN0IGRhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcclxuICBkYXRlLmlubmVySFRNTCA9IG5ldyBEYXRlKHJldmlldy5jcmVhdGVkQXQpLnRvTG9jYWxlRGF0ZVN0cmluZygpO1xyXG4gIGRhdGUuY2xhc3NOYW1lID0gJ2RhdGUnO1xyXG4gIGRhdGUuc2V0QXR0cmlidXRlKCdhbHQnLCAnRGF0ZSByZXZpZXdlZCcpO1xyXG4gIGxpLmFwcGVuZENoaWxkKGRhdGUpO1xyXG5cclxuICBjb25zdCByYXRpbmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcclxuICByYXRpbmcuaW5uZXJIVE1MID0gYFJhdGluZzogJHtyZXZpZXcucmF0aW5nfWA7XHJcbiAgcmF0aW5nLmNsYXNzTmFtZSA9ICdyYXRpbmcnO1xyXG4gIHJhdGluZy5zZXRBdHRyaWJ1dGUoJ2FsdCcsICdSYXRpbmcgZ2l2ZW4gYnkgcmV2aWV3ZXInKTtcclxuICBsaS5hcHBlbmRDaGlsZChyYXRpbmcpO1xyXG5cclxuICBjb25zdCBjb21tZW50cyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xyXG4gIGNvbW1lbnRzLmlubmVySFRNTCA9IHJldmlldy5jb21tZW50cztcclxuICBjb21tZW50cy5jbGFzc05hbWUgPSAnY29tbWVudHMnO1xyXG4gIGNvbW1lbnRzLnNldEF0dHJpYnV0ZSgnYWx0JywgJ0NvbW1lbnRzIHdyaXR0ZW4gYnkgcmV2aWV3ZXInKTtcclxuICBsaS5hcHBlbmRDaGlsZChjb21tZW50cyk7XHJcblxyXG4gIHJldHVybiBsaTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENsZWFyIGZvcm0gZGF0YVxyXG4gKi9cclxuZnVuY3Rpb24gY2xlYXJGb3JtKCkge1xyXG4gIC8vIGNsZWFyIGZvcm0gZGF0YVxyXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmFtZVwiKS52YWx1ZSA9IFwiXCI7XHJcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyYXRpbmdcIikuc2VsZWN0ZWRJbmRleCA9IDA7XHJcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21tZW50c1wiKS52YWx1ZSA9IFwiXCI7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZW1vdmUgbm8gcmV2aWV3IGVsZW1lbnRcclxuICovXHJcbmZ1bmN0aW9uIHJlbW92ZU5vUmV2aWV3cygpIHtcclxuICBjb25zdCBub1Jldmlld3MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm5vLXJldmlld3NcIik7XHJcbiAgXHJcbiAgaWYobm9SZXZpZXdzKSBub1Jldmlld3MucmVtb3ZlKCk7XHJcblxyXG59XHJcblxyXG4vKipcclxuICogTWFrZSBzdXJlIGFsbCBmb3JtIGZpZWxkcyBoYXZlIGEgdmFsdWUgYW5kIHJldHVybiBkYXRhIGluXHJcbiAqIGFuIG9iamVjdCwgc28gaXMgcmVhZHkgZm9yIGEgUE9TVCByZXF1ZXN0LlxyXG4gKi9cclxuZnVuY3Rpb24gdmFsaWRhdGVBbmRHZXREYXRhKCkge1xyXG4gIGNvbnN0IGRhdGEgPSB7fTtcclxuXHJcbiAgLy8gZ2V0IG5hbWVcclxuICBsZXQgbmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibmFtZVwiKTtcclxuICBpZiAobmFtZS52YWx1ZSA9PT0gXCJcIikge1xyXG4gICAgbmFtZS5mb2N1cygpO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuICBkYXRhLm5hbWUgPSBuYW1lLnZhbHVlO1xyXG5cclxuICAvLyBnZXQgcmF0aW5nXHJcbiAgY29uc3QgcmF0aW5nU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyYXRpbmdcIik7XHJcbiAgY29uc3QgcmF0aW5nID0gcmF0aW5nU2VsZWN0Lm9wdGlvbnNbcmF0aW5nU2VsZWN0LnNlbGVjdGVkSW5kZXhdLnZhbHVlO1xyXG4gIGlmIChyYXRpbmcgPT0gXCItLVwiKSB7XHJcbiAgICByYXRpbmdTZWxlY3QuZm9jdXMoKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcbiAgZGF0YS5yYXRpbmcgPSBOdW1iZXIocmF0aW5nKTtcclxuXHJcbiAgLy8gZ2V0IGNvbW1lbnRzXHJcbiAgbGV0IGNvbW1lbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb21tZW50c1wiKTtcclxuICBpZiAoY29tbWVudHMudmFsdWUgPT09IFwiXCIpIHtcclxuICAgIGNvbW1lbnRzLmZvY3VzKCk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIGRhdGEuY29tbWVudHMgPSBjb21tZW50cy52YWx1ZTtcclxuXHJcbiAgLy8gZ2V0IHJlc3RhdXJhbnRfaWRcclxuICBsZXQgcmVzdGF1cmFudElkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXZpZXctZm9ybVwiKS5kYXRhc2V0XHJcbiAgICAucmVzdGF1cmFudElkO1xyXG4gIGRhdGEucmVzdGF1cmFudF9pZCA9IE51bWJlcihyZXN0YXVyYW50SWQpO1xyXG4gIGRhdGEuY3JlYXRlZEF0ID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xyXG5cclxuICByZXR1cm4gZGF0YTtcclxufVxyXG5cclxuXHJcblxyXG4vKipcclxuICogR3JhYiB0aGUgcmV2aWV3IGFuZCBzZW5kIGl0IHRvIHRoZSBkb20sIHdoaWxlIHlvdSBhcmUgYXQgaXQgY2xlYXIgdGhlIG5vIHJldmlld3MgZWwsIGFuZCBjbGVhciBmb3JtXHJcbiAqL1xyXG5mdW5jdGlvbiBpbnNlcnRSZXZpZXdBbmRDbGVhcihyZXZpZXcpIHtcclxuICAvLyBwb3N0IG5ldyByZXZpZXcgb24gcGFnZVxyXG4gIGNvbnN0IHJldmlld0xpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJldmlld3MtbGlzdFwiKTtcclxuICBjb25zdCByZXZpZXdFbCA9IGNyZWF0ZVJldmlld0hUTUwocmV2aWV3KTtcclxuICByZXZpZXdMaXN0LmFwcGVuZENoaWxkKHJldmlld0VsKTtcclxuICAvL3JlbW92ZSBub1Jldmlld3MgZWxlbWVudFxyXG4gIHJlbW92ZU5vUmV2aWV3cygpO1xyXG5cclxuICAvLyBjbGVhciBmb3JtXHJcbiAgY2xlYXJGb3JtKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBIYW5kbGUgc3VibWl0LlxyXG4gKi9cclxuZnVuY3Rpb24gaGFuZGxlU3VibWl0KGUpIHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3QgcmV2aWV3ID0gdmFsaWRhdGVBbmRHZXREYXRhKCk7XHJcbiAgY29uc3QgdXJsID0gYCR7REJIZWxwZXIuQVBJX1VSTH0vcmV2aWV3cy9gO1xyXG4gIGNvbnN0IFBPU1QgPSB7XHJcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkocmV2aWV3KVxyXG4gIH07XHJcblxyXG4gIC8vIElmIHdlIGFyZSBvZmZsaW5lXHJcbiAgaWYoIW5hdmlnYXRvci5vbkxpbmUpIHtcclxuICAgIGNvbnNvbGUuaW5mbygnQXBwIHdhcyBvZmZsaW5lLCB3aGVuIHlvdSB0cmllZCB0byBzZW5kIHJldmlldycpO1xyXG4gICAgXHJcbiAgICBkYlByb21pc2UucHV0T2ZmbGluZVJldmlldyhyZXZpZXcsIFwicmV2aWV3XCIpO1xyXG4gICAgaW5zZXJ0UmV2aWV3QW5kQ2xlYXIocmV2aWV3KTtcclxuXHJcbiAgfVxyXG4gIC8vIElmIHdlIGFyZSBvbmxpbmVcclxuICByZXR1cm4gZmV0Y2godXJsLCBQT1NUKVxyXG4gICAgLnRoZW4ocmVzcG9uc2UgPT4ge1xyXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFwiV2UgY291bGRuJ3QgcG9zdCByZXZpZXcgdG8gc2VydmVyLlwiKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xyXG4gICAgfSkuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmluZm8oJ0Rpc2Nvbm5lY3RlZCB3aGVuIHN1Ym1pdHRlZCBmb3JtJyk7XHJcbiAgICB9KVxyXG4gICAgLnRoZW4oYXBpUmV2aWV3ID0+IHtcclxuICAgICAgaW5zZXJ0UmV2aWV3QW5kQ2xlYXIoYXBpUmV2aWV3KVxyXG4gICAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIFJldHVybnMgYSBmb3JtIGVsZW1lbnQgZm9yIHBvc3RpbmcgbmV3IHJldmlld3MuXHJcbiAqL1xyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiByZXZpZXdGb3JtKHJlc3RhdXJhbnRJZCkge1xyXG4gIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZm9ybVwiKTtcclxuICBmb3JtLmlkID0gXCJyZXZpZXctZm9ybVwiO1xyXG4gIGZvcm0uZGF0YXNldC5yZXN0YXVyYW50SWQgPSByZXN0YXVyYW50SWQ7XHJcblxyXG4gIGxldCBwID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XHJcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTtcclxuICBuYW1lLmlkID0gXCJuYW1lXCI7XHJcbiAgbmFtZS5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwidGV4dFwiKTtcclxuICBuYW1lLnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgXCJOYW1lXCIpO1xyXG4gIG5hbWUuc2V0QXR0cmlidXRlKFwicGxhY2Vob2xkZXJcIiwgXCJOYW1lXCIpO1xyXG4gIHAuYXBwZW5kQ2hpbGQobmFtZSk7XHJcbiAgZm9ybS5hcHBlbmRDaGlsZChwKTtcclxuXHJcbiAgcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xyXG4gIGNvbnN0IHNlbGVjdExhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO1xyXG4gIHNlbGVjdExhYmVsLnNldEF0dHJpYnV0ZShcImZvclwiLCBcInJhdGluZ1wiKTtcclxuICBzZWxlY3RMYWJlbC5pbm5lclRleHQgPSBcIllvdXIgcmF0aW5nOiBcIjtcclxuICBwLmFwcGVuZENoaWxkKHNlbGVjdExhYmVsKTtcclxuICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2VsZWN0XCIpO1xyXG4gIHNlbGVjdC5pZCA9IFwicmF0aW5nXCI7XHJcbiAgc2VsZWN0Lm5hbWUgPSBcInJhdGluZ1wiO1xyXG4gIHNlbGVjdC5jbGFzc0xpc3QuYWRkKFwicmF0aW5nXCIpO1xyXG4gIFtcIi0tXCIsIDEsIDIsIDMsIDQsIDVdLmZvckVhY2gobnVtYmVyID0+IHtcclxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIik7XHJcbiAgICBvcHRpb24udmFsdWUgPSBudW1iZXI7XHJcbiAgICBvcHRpb24uaW5uZXJIVE1MID0gbnVtYmVyO1xyXG4gICAgaWYgKG51bWJlciA9PT0gXCItLVwiKSBvcHRpb24uc2VsZWN0ZWQgPSB0cnVlO1xyXG4gICAgc2VsZWN0LmFwcGVuZENoaWxkKG9wdGlvbik7XHJcbiAgfSk7XHJcbiAgcC5hcHBlbmRDaGlsZChzZWxlY3QpO1xyXG4gIGZvcm0uYXBwZW5kQ2hpbGQocCk7XHJcblxyXG4gIHAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcclxuICBjb25zdCB0ZXh0YXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0ZXh0YXJlYVwiKTtcclxuICB0ZXh0YXJlYS5pZCA9IFwiY29tbWVudHNcIjtcclxuICB0ZXh0YXJlYS5zZXRBdHRyaWJ1dGUoXCJhcmlhLWxhYmVsXCIsIFwiY29tbWVudHNcIik7XHJcbiAgdGV4dGFyZWEuc2V0QXR0cmlidXRlKFwicGxhY2Vob2xkZXJcIiwgXCJFbnRlciBhbnkgY29tbWVudHMgaGVyZVwiKTtcclxuICB0ZXh0YXJlYS5zZXRBdHRyaWJ1dGUoXCJyb3dzXCIsIFwiMTBcIik7XHJcbiAgcC5hcHBlbmRDaGlsZCh0ZXh0YXJlYSk7XHJcbiAgZm9ybS5hcHBlbmRDaGlsZChwKTtcclxuXHJcbiAgcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xyXG4gIGNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcbiAgYWRkQnV0dG9uLnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJzdWJtaXRcIik7XHJcbiAgYWRkQnV0dG9uLnNldEF0dHJpYnV0ZShcImFyaWEtbGFiZWxcIiwgXCJBZGQgUmV2aWV3XCIpO1xyXG4gIGFkZEJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiYWRkLXJldmlld1wiKTtcclxuICBhZGRCdXR0b24uaW5uZXJIVE1MID0gXCI8c3Bhbj4rPC9zcGFuPlwiO1xyXG4gIHAuYXBwZW5kQ2hpbGQoYWRkQnV0dG9uKTtcclxuICBmb3JtLmFwcGVuZENoaWxkKHApO1xyXG5cclxuICBmb3JtLm9uc3VibWl0ID0gaGFuZGxlU3VibWl0O1xyXG5cclxuICByZXR1cm4gZm9ybTtcclxufVxyXG4iXX0="}